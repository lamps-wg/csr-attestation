<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Use of Remote Attestation with Certification Signing Requests</title>
<meta content="Mike Ounsworth" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Monty Wiseman" name="author">
<meta content="Ned Smith" name="author">
<meta content="
       A PKI end entity requesting a certificate from a Certification Authority (CA) may wish to offer trustworthy claims about the platform generating the certification request and the environment associated with the corresponding private key, such as whether the private key resides on a hardware security module. 
       This specification defines an attribute and an extension that allow for conveyance of Evidence and
Attestation Results in Certificate Signing Requests (CSRs), such as PKCS#10 or Certificate Request Message Format (CRMF) payloads. This provides an elegant and automatable mechanism for transporting Evidence to a Certification Authority. 
       Including Evidence and Attestation Results along with a CSR can help to improve the assessment of the security posture for the private key, and can help the Certification Authority to assess whether it satisfies the requested certificate profile. 
    " name="description">
<meta content="xml2rfc 3.26.0" name="generator">
<meta content="PKI" name="keyword">
<meta content="PKCS#10" name="keyword">
<meta content="CRMF" name="keyword">
<meta content="Attestation" name="keyword">
<meta content="Evidence" name="keyword">
<meta content="Certificate Signing Requests" name="keyword">
<meta content="draft-ietf-lamps-csr-attestation-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.26.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-lamps-csr-attestation.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Remote Attestation with CSRs</td>
<td class="right">February 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Ounsworth, et al.</td>
<td class="center">Expires 14 August 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-lamps-csr-attestation-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-02-10" class="published">10 February 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-08-14">14 August 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Ounsworth</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">M. Wiseman</div>
<div class="org">Beyond Identity</div>
</div>
<div class="author">
      <div class="author-name">N. Smith</div>
<div class="org">Intel Corporation</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Use of Remote Attestation with Certification Signing Requests</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">A PKI end entity requesting a certificate from a Certification Authority (CA) may wish to offer trustworthy claims about the platform generating the certification request and the environment associated with the corresponding private key, such as whether the private key resides on a hardware security module.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This specification defines an attribute and an extension that allow for conveyance of Evidence and
Attestation Results in Certificate Signing Requests (CSRs), such as PKCS#10 or Certificate Request Message Format (CRMF) payloads. This provides an elegant and automatable mechanism for transporting Evidence to a Certification Authority.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">Including Evidence and Attestation Results along with a CSR can help to improve the assessment of the security posture for the private key, and can help the Certification Authority to assess whether it satisfies the requested certificate profile.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://lamps-wg.github.io/csr-attestation/draft-ietf-lamps-csr-attestation.html">https://lamps-wg.github.io/csr-attestation/draft-ietf-lamps-csr-attestation.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-csr-attestation/">https://datatracker.ietf.org/doc/draft-ietf-lamps-csr-attestation/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/lamps-wg/csr-attestation">https://github.com/lamps-wg/csr-attestation</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 14 August 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-architecture" class="internal xref">Architecture</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-information-model" class="internal xref">Information Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-model-for-evidence-in-csr" class="internal xref">Model for Evidence in CSR</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-case-1-evidence-bundle-with" class="internal xref">Case 1 - Evidence Bundle without Certificate Chain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-case-2-evidence-bundle-with" class="internal xref">Case 2 - Evidence Bundle with Certificate Chain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-case-3-evidence-bundles-wit" class="internal xref">Case 3 - Evidence Bundles with Multiple Evidence Statements and Complete Certificate Chains</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-model-for-attestation-resul" class="internal xref">Model for Attestation Result in CSR</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-asn1-elements-for-evidence-" class="internal xref">ASN.1 Elements for Evidence in CSR</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-object-identifiers" class="internal xref">Object Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-evidence-attribute-and-exte" class="internal xref">Evidence Attribute and Extension</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-asn1-elements-for-attestati" class="internal xref">ASN.1 Elements for Attestation Result in CSR</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-object-identifiers-2" class="internal xref">Object Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-attestation-result-attribut" class="internal xref">Attestation Result Attribute and Extension</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-module-registration-smi-sec" class="internal xref">Module Registration - SMI Security for PKIX Module Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-object-identifier-registrat" class="internal xref">Object Identifier Registrations - SMI Security for S/MIME Attributes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-smi-security-for-pkix-evide" class="internal xref">"SMI Security for PKIX Evidence Statement Formats" Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-attestation-evidence-oid-re" class="internal xref">Attestation Evidence OID Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="auto internal xref">7.4.1</a>.  <a href="#name-registration-template" class="internal xref">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="auto internal xref">7.4.2</a>.  <a href="#name-initial-registry-contents" class="internal xref">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-background-check-model-secu" class="internal xref">Background Check Model Security Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-freshness-for-the-backgroun" class="internal xref">Freshness for the Background Check Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-publishing-evidence-in-an-x" class="internal xref">Publishing Evidence in an X.509 Extension</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-type-oid-and-verifier-hint" class="internal xref">Type OID and verifier hint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-additional-security-conside" class="internal xref">Additional Security Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-extending-evidencestatement" class="internal xref">Extending EvidenceStatementSet</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-tpm-v20-evidence-in-csr" class="internal xref">TPM V2.0 Evidence in CSR</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#appendix-A.2.1" class="auto internal xref">A.2.1</a>.  <a href="#name-tcg-key-attestation-certify" class="internal xref">TCG Key Attestation Certify</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a href="#appendix-A.2.2" class="auto internal xref">A.2.2</a>.  <a href="#name-tcg-oids" class="internal xref">TCG OIDs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.3">
                    <p id="section-toc.1-1.10.2.2.2.3.1"><a href="#appendix-A.2.3" class="auto internal xref">A.2.3</a>.  <a href="#name-tpm2-attestationstatement" class="internal xref">TPM2 AttestationStatement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.4">
                    <p id="section-toc.1-1.10.2.2.2.4.1"><a href="#appendix-A.2.4" class="auto internal xref">A.2.4</a>.  <a href="#name-introduction-to-tpm2-concep" class="internal xref">Introduction to TPM2 concepts</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.5">
                    <p id="section-toc.1-1.10.2.2.2.5.1"><a href="#appendix-A.2.5" class="auto internal xref">A.2.5</a>.  <a href="#name-tcg-objects-and-key-attesta" class="internal xref">TCG Objects and Key Attestation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.6">
                    <p id="section-toc.1-1.10.2.2.2.6.1"><a href="#appendix-A.2.6" class="auto internal xref">A.2.6</a>.  <a href="#name-sample-csr" class="internal xref">Sample CSR</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-psa-attestation-token-in-cs" class="internal xref">PSA Attestation Token in CSR</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-confidential-compute-archit" class="internal xref">Confidential Compute Architecture (CCA) Platform Token in CSR</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-asn1-module" class="internal xref">ASN.1 Module</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-tcg-dice-example-in-asn1" class="internal xref">TCG DICE Example in ASN.1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-tcg-dice-tcbinfo-example-in" class="internal xref">TCG DICE TcbInfo Example in CSR</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">When requesting a certificate from a Certification Authority (CA), a PKI end entity may wish to include Evidence or Attestation Results of the security properties of its environments in which the private keys are stored in that request.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Evidence are appraised by Verifiers, which typically produces Attestation Results that serve as input for validating incoming certificate requests against specified certificate policies.
Verifiers are associated with Registration Authorities (RAs) or CAs and function as logical entities responsible for processing Evidence and producing Attestation Results.
As remote attestation technology matures, it is natural for a Certification Authority to want proof that the requesting entity is in a state that matches the certificate profile.
At the time of writing, the most notable example is the Code-Signing Baseline Requirements (CSBR) document maintained by the CA/Browser Forum <span>[<a href="#CSBR" class="cite xref">CSBR</a>]</span>, which requires compliant CAs to "ensure that a Subscriber’s Private Key is generated, stored,
and used in a secure environment that has controls to prevent theft or misuse", which is a natural fit to enforce via remote attestation.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This specification defines an attribute and an extension that allow for conveyance of Evidence and Attestation Results in Certificate Signing Requests (CSRs), such as PKCS#10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span> or Certificate Request Message Format (CRMF) <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> payloads.
This CSR extension satisfies CA/B Forum's CSBR <span>[<a href="#CSBR" class="cite xref">CSBR</a>]</span> requirements for key protection assurance.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">As outlined in the IETF RATS architecture <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, an Attester (typically a device) produces a signed collection of Claims that constitute Evidence about its running environment(s).
The term "attestation" is not explicitly defined in RFC 9334 but was later clarified in <span>[<a href="#I-D.ietf-rats-tpm-based-network-device-attest" class="cite xref">I-D.ietf-rats-tpm-based-network-device-attest</a>]</span>.
It refers to the process of generating and evaluating remote attestation Evidence.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">After the Verifier appraises the Evidence, it generates a new structure called an Attestation Result.
A Relying Party utilizes Attestation Results to inform risk or policy-based decisions that consider trustworthiness of the attested entity.
This document relies on <a href="#architecture" class="auto internal xref">Section 3</a> as the foundation for how the various roles within the RATS architecture correspond to a certificate requester and a CA/RA.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The IETF RATS architecture <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> defines two communication patterns: the <em>background-check model</em> and the <em>passport model</em>.
In the background-check model, the Relying Party receives Evidence in the CSR from the Attester and must interact with a Verifier service directly to obtain Attestation Results.
In contrast, the passport model requires the Attester to first interact with the Verifier service to obtain an Attestation Result token that is then relayed to the Relying Party.
This specification defines both communication patterns.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Several standard and proprietary remote attestation technologies are in use. This specification thereby is intended to be as technology-agnostic as it is feasible with respect to implemented remote attestation technologies. Hence, this specification focuses on (1) the conveyance of Evidence and Attestation Results via CSRs while making minimal assumptions about content or format of the transported payload and (2) the conveyance of sets of certificates used for validation of Evidence.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">The certificates typically contain one or more certification paths rooted in a device manufacturer trust anchor and the end entity certificate being on the device in question. The end entity certificate is associated with key material that takes on the role of an Attestation Key and is used as Evidence originating from the Attester.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">This document specifies a CSR Attribute (or Extension for Certificate Request Message Format (CRMF) CSRs) for carrying Evidence and Attestation Results.<a href="#section-1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-10.1">
          <p id="section-1-10.1.1">Evidence is placed into an EvidenceStatement along with an OID to identify its type and optionally a hint to the Relying Party about which Verifier (software package, a microservice or some other service) will be capable of parsing it. A set of EvidenceStatement structures may be grouped together along with the set of CertificateChoice structures needed to validate them to form a EvidenceBundle.<a href="#section-1-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-10.2">
          <p id="section-1-10.2.1">Attestation Results are carried in the AttestationResult along with an OID to identify its type. A set of AttestationResult structures may be grouped together to form an AttestationResultBundle.<a href="#section-1-10.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-11">A CSR may contain one or more Evidence payloads. For example Evidence
asserting the storage properties of a private key, Evidence
asserting firmware version and other general properties
of the device, or Evidence signed using different cryptographic
algorithms. Like-wise a CSR may also contain one or more Attestation Result payloads.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">With these attributes, additional
information is available to an RA or CA, which may be used
to decide whether to issue a certificate and what certificate profile
to apply. The scope of this document is, however,
limited to the conveyance of Evidence and Attestation Results within CSR. The exact format of the
Evidence and Attestation Results being conveyed is defined in various standard and proprietary
specifications.<a href="#section-1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document re-uses the terms defined in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> related to remote
attestation. Readers of this document are assumed to be familiar with
the following terms: Evidence, Claim, Attestation Result (AR), Attester,
Verifier, Target Environment, Attesting Environment, Composite Device,
Lead Attester, Attestation Key, and Relying Party (RP).<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The term "Certification Request" message is defined in <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>.
Specifications, such as <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>, later introduced the term
"Certificate Signing Request (CSR)" to refer to the Certification
Request message. While the term "Certification Request"
would have been correct, the mistake was unnoticed. In the meanwhile
CSR is an abbreviation used beyond PKCS#10. Hence, it is equally
applicable to other protocols that use a different syntax and
even a different encoding, in particular this document also
considers messages in the Certificate Request Message Format (CRMF) <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>
to be "CSRs". In this document, the terms "CSR" and Certificate Request
message are used interchangeably.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The term Hardware Security Modules (HSM) is used generically to refer to the
combination of hardware and software designed to protect keys from unauthorized
access. Other commonly used terms include Secure Element and Trusted Execution
Environment.<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="architecture">
<section id="section-3">
      <h2 id="name-architecture">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-architecture" class="section-name selfRef">Architecture</a>
      </h2>
<p id="section-3-1"><a href="#fig-arch-background" class="auto internal xref">Figure 1</a> shows the high-level communication pattern of the RATS
background check model where the Attester transmits the Evidence in the
CSR to the RA and the CA, which is subsequently forwarded to the Verifier.
The Verifier appraises the received Evidence and computes an Attestation
Result, which is then processed by the RA/CA prior to the certificate
issuance.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">In addition to the background-check model, the RATS architecture also
defines the passport model, as described in <span><a href="https://rfc-editor.org/rfc/rfc9334#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.
In the passport model, the Attester transmits Evidence directly to the
Verifier to obtain an Attestation Result, which is subsequently forwarded
to the Relying Party.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The choice of model depends on various factors. For instance, the
background-check model is preferred when direct real-time interaction
between the Attester and the Verifier is not feasible.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Note that the Verifier is a logical role that may be included in the
RA/CA product. In this case, the Relying Party role and Verifier role collapse into a
single physical entity. The Verifier functionality can, however,
also be kept separate from the RA functionality. For example,
security concerns may require parsers of Evidence formats to be logically
or physically separated from the core RA and CA functionality.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">The interface
by which the Relying Party passes Evidence to the Verifier and receives back
Attestation Results may be proprietary or standardized, but in any case is
out-of-scope for this document. Like-wise, the interface between the Attester
and the Verifier used in the passport model is also out-of-scope for this
document.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6"><a href="#fig-arch-background" class="auto internal xref">Figure 1</a> shows an example data flow where Evidence is included in a
CSR in the background-check model. The CSR is parsed by the RA component of a
CA, which extracts the Evidence and forwards it to a
trusted Verifier. The RA receives back an Attestation Result, which it uses
to decide whether this Evidence meets its policy for certificate issuance
and if it does then the certificate request is forwarded to the CA for issuance.
This diagram overlays PKI entities with RATS roles in parentheses.<a href="#section-3-6" class="pilcrow">¶</a></p>
<span id="name-example-data-flow-demonstra"></span><div id="fig-arch-background">
<figure id="figure-1">
        <div id="section-3-7.1">
          <div class="alignLeft art-svg artwork" id="section-3-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="272" width="552" viewBox="0 0 552 272" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,176 L 8,256" fill="none" stroke="black"></path>
              <path d="M 112,176 L 112,256" fill="none" stroke="black"></path>
              <path d="M 216,32 L 216,96" fill="none" stroke="black"></path>
              <path d="M 216,176 L 216,256" fill="none" stroke="black"></path>
              <path d="M 256,104 L 256,192" fill="none" stroke="black"></path>
              <path d="M 320,96 L 320,192" fill="none" stroke="black"></path>
              <path d="M 360,32 L 360,96" fill="none" stroke="black"></path>
              <path d="M 360,176 L 360,256" fill="none" stroke="black"></path>
              <path d="M 496,176 L 496,256" fill="none" stroke="black"></path>
              <path d="M 544,176 L 544,256" fill="none" stroke="black"></path>
              <path d="M 216,32 L 360,32" fill="none" stroke="black"></path>
              <path d="M 216,96 L 360,96" fill="none" stroke="black"></path>
              <path d="M 8,176 L 112,176" fill="none" stroke="black"></path>
              <path d="M 216,176 L 248,176" fill="none" stroke="black"></path>
              <path d="M 264,176 L 312,176" fill="none" stroke="black"></path>
              <path d="M 328,176 L 360,176" fill="none" stroke="black"></path>
              <path d="M 496,176 L 544,176" fill="none" stroke="black"></path>
              <path d="M 112,192 L 208,192" fill="none" stroke="black"></path>
              <path d="M 224,192 L 256,192" fill="none" stroke="black"></path>
              <path d="M 320,192 L 352,192" fill="none" stroke="black"></path>
              <path d="M 368,192 L 488,192" fill="none" stroke="black"></path>
              <path d="M 8,256 L 112,256" fill="none" stroke="black"></path>
              <path d="M 216,256 L 360,256" fill="none" stroke="black"></path>
              <path d="M 496,256 L 544,256" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="496,192 484,186.4 484,197.6" fill="black" transform="rotate(0,488,192)"></polygon>
              <polygon class="arrowhead" points="360,192 348,186.4 348,197.6" fill="black" transform="rotate(0,352,192)"></polygon>
              <polygon class="arrowhead" points="328,168 316,162.4 316,173.6" fill="black" transform="rotate(90,320,168)"></polygon>
              <polygon class="arrowhead" points="264,104 252,98.4 252,109.6" fill="black" transform="rotate(270,256,104)"></polygon>
              <polygon class="arrowhead" points="216,192 204,186.4 204,197.6" fill="black" transform="rotate(0,208,192)"></polygon>
              <g class="text">
                <text x="400" y="52">Compare</text>
                <text x="468" y="52">Evidence</text>
                <text x="292" y="68">(Verifier)</text>
                <text x="400" y="68">against</text>
                <text x="472" y="68">Appraisal</text>
                <text x="396" y="84">Policy</text>
                <text x="212" y="132">Evidence</text>
                <text x="376" y="132">Attestation</text>
                <text x="356" y="148">Result</text>
                <text x="32" y="212">End</text>
                <text x="156" y="212">Evidence</text>
                <text x="276" y="212">Registration</text>
                <text x="416" y="212">Attestation</text>
                <text x="516" y="212">CA</text>
                <text x="44" y="228">Entity</text>
                <text x="132" y="228">in</text>
                <text x="160" y="228">CSR</text>
                <text x="264" y="228">Authority</text>
                <text x="324" y="228">(RA)</text>
                <text x="396" y="228">Result</text>
                <text x="436" y="228">in</text>
                <text x="516" y="228">(RP)</text>
                <text x="60" y="244">(Attester)</text>
                <text x="260" y="244">(Relying</text>
                <text x="324" y="244">Party)</text>
                <text x="384" y="244">CSR</text>
              </g>
            </svg><a href="#section-3-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-example-data-flow-demonstra" class="selfRef">Example data flow demonstrating the architecture with Background Check Model.</a>
        </figcaption></figure>
</div>
<p id="section-3-8"><a href="#fig-arch-passport" class="auto internal xref">Figure 2</a> illustrates the passport model, where the
Attester first communicates with the Verifier to obtain the Attestation
Result, which is subsequently included in the CSR.<a href="#section-3-8" class="pilcrow">¶</a></p>
<span id="name-example-data-flow-demonstrat"></span><div id="fig-arch-passport">
<figure id="figure-2">
        <div id="section-3-9.1">
          <div class="alignLeft art-svg artwork" id="section-3-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="552" viewBox="0 0 552 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,160 L 8,240" fill="none" stroke="black"></path>
              <path d="M 32,48 L 32,152" fill="none" stroke="black"></path>
              <path d="M 80,80 L 80,176" fill="none" stroke="black"></path>
              <path d="M 112,160 L 112,240" fill="none" stroke="black"></path>
              <path d="M 216,32 L 216,96" fill="none" stroke="black"></path>
              <path d="M 224,160 L 224,240" fill="none" stroke="black"></path>
              <path d="M 360,32 L 360,96" fill="none" stroke="black"></path>
              <path d="M 368,160 L 368,240" fill="none" stroke="black"></path>
              <path d="M 488,160 L 488,240" fill="none" stroke="black"></path>
              <path d="M 544,160 L 544,240" fill="none" stroke="black"></path>
              <path d="M 216,32 L 360,32" fill="none" stroke="black"></path>
              <path d="M 32,48 L 208,48" fill="none" stroke="black"></path>
              <path d="M 80,80 L 208,80" fill="none" stroke="black"></path>
              <path d="M 216,96 L 360,96" fill="none" stroke="black"></path>
              <path d="M 8,160 L 72,160" fill="none" stroke="black"></path>
              <path d="M 88,160 L 112,160" fill="none" stroke="black"></path>
              <path d="M 224,160 L 368,160" fill="none" stroke="black"></path>
              <path d="M 488,160 L 544,160" fill="none" stroke="black"></path>
              <path d="M 80,176 L 216,176" fill="none" stroke="black"></path>
              <path d="M 376,176 L 480,176" fill="none" stroke="black"></path>
              <path d="M 8,240 L 112,240" fill="none" stroke="black"></path>
              <path d="M 224,240 L 368,240" fill="none" stroke="black"></path>
              <path d="M 488,240 L 544,240" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="488,176 476,170.4 476,181.6" fill="black" transform="rotate(0,480,176)"></polygon>
              <polygon class="arrowhead" points="224,176 212,170.4 212,181.6" fill="black" transform="rotate(0,216,176)"></polygon>
              <polygon class="arrowhead" points="216,48 204,42.4 204,53.6" fill="black" transform="rotate(0,208,48)"></polygon>
              <polygon class="arrowhead" points="112,176 100,170.4 100,181.6" fill="black" transform="rotate(0,104,176)"></polygon>
              <polygon class="arrowhead" points="88,152 76,146.4 76,157.6" fill="black" transform="rotate(90,80,152)"></polygon>
              <g class="text">
                <text x="60" y="36">Evidence</text>
                <text x="400" y="52">Compare</text>
                <text x="468" y="52">Evidence</text>
                <text x="284" y="68">(Verifier)</text>
                <text x="400" y="68">against</text>
                <text x="472" y="68">Appraisal</text>
                <text x="396" y="84">Policy</text>
                <text x="136" y="116">Attestation</text>
                <text x="116" y="132">Result</text>
                <text x="284" y="180">Registration</text>
                <text x="32" y="196">End</text>
                <text x="168" y="196">Attestation</text>
                <text x="272" y="196">Authority</text>
                <text x="424" y="196">Attestation</text>
                <text x="516" y="196">CA</text>
                <text x="44" y="212">Entity</text>
                <text x="148" y="212">Result</text>
                <text x="188" y="212">in</text>
                <text x="404" y="212">Result</text>
                <text x="444" y="212">in</text>
                <text x="516" y="212">(RP)</text>
                <text x="60" y="228">(Attester)</text>
                <text x="136" y="228">CSR</text>
                <text x="268" y="228">(Relying</text>
                <text x="332" y="228">Party)</text>
                <text x="392" y="228">CSR</text>
              </g>
            </svg><a href="#section-3-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-data-flow-demonstrat" class="selfRef">Example data flow demonstrating the architecture with Passport Model.</a>
        </figcaption></figure>
</div>
<p id="section-3-10">RFC 9334 <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> discusses different security and privacy aspects that need to be
considered when developing and deploying a remote attestation solution. For example,
Evidence may need to be protected against replay and <span><a href="https://rfc-editor.org/rfc/rfc9334#section-10" class="relref">Section 10</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> lists
approach for offering freshness. There are also concerns about the exposure of
persistent identifiers by utilizing attestation technology, which are discussed in
<span><a href="https://rfc-editor.org/rfc/rfc9334#section-11" class="relref">Section 11</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. Finally, the keying material used by the Attester needs to
be protected against unauthorized access, and against signing arbitrary content that
originated from outside the device. This aspect is described in <span><a href="https://rfc-editor.org/rfc/rfc9334#section-12" class="relref">Section 12</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.
Most of these aspects are, however, outside the scope of this specification but relevant
for use with a given attestation technology.<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">The focus of this specification is on the transport of Evidence and Attesation Results
from the Attester to the Relying Party via existing CSR messages.<a href="#section-3-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="information-model">
<section id="section-4">
      <h2 id="name-information-model">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-information-model" class="section-name selfRef">Information Model</a>
      </h2>
<div id="model-for-evidence-in-csr">
<section id="section-4.1">
        <h3 id="name-model-for-evidence-in-csr">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-model-for-evidence-in-csr" class="section-name selfRef">Model for Evidence in CSR</a>
        </h3>
<p id="section-4.1-1">To support a number of different use cases for the transmission of
Evidence and certificate chains in a CSR the structure
shown in <a href="#fig-info-model" class="auto internal xref">Figure 3</a> is used.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">On a high-level, the structure is composed as follows:
A PKCS#10 attribute or a CRMF extension contains one
EvidenceBundle structure. The EvidenceBundle contains one or more
EvidenceStatement structures as well as one or more
CertificateChoices which enable to carry various format of
certificates.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Note: Since an extension must only be included once in a certificate
see <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, this PKCS#10 attribute
or the CRMF extension <span class="bcp14">MUST</span> only be included once in a CSR.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<span id="name-information-model-for-csr-e"></span><div id="fig-info-model">
<figure id="figure-3">
          <div id="section-4.1-4.1">
            <div class="alignLeft art-svg artwork" id="section-4.1-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="368" width="488" viewBox="0 0 488 368" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,96" fill="none" stroke="black"></path>
                <path d="M 8,240 L 8,272" fill="none" stroke="black"></path>
                <path d="M 80,104 L 80,232" fill="none" stroke="black"></path>
                <path d="M 152,144 L 152,232" fill="none" stroke="black"></path>
                <path d="M 168,32 L 168,96" fill="none" stroke="black"></path>
                <path d="M 176,240 L 176,272" fill="none" stroke="black"></path>
                <path d="M 264,128 L 264,208" fill="none" stroke="black"></path>
                <path d="M 320,240 L 320,336" fill="none" stroke="black"></path>
                <path d="M 472,128 L 472,208" fill="none" stroke="black"></path>
                <path d="M 480,240 L 480,336" fill="none" stroke="black"></path>
                <path d="M 8,32 L 168,32" fill="none" stroke="black"></path>
                <path d="M 8,96 L 168,96" fill="none" stroke="black"></path>
                <path d="M 264,128 L 472,128" fill="none" stroke="black"></path>
                <path d="M 152,144 L 256,144" fill="none" stroke="black"></path>
                <path d="M 264,160 L 472,160" fill="none" stroke="black"></path>
                <path d="M 264,208 L 472,208" fill="none" stroke="black"></path>
                <path d="M 8,240 L 176,240" fill="none" stroke="black"></path>
                <path d="M 320,240 L 480,240" fill="none" stroke="black"></path>
                <path d="M 184,256 L 312,256" fill="none" stroke="black"></path>
                <path d="M 8,272 L 176,272" fill="none" stroke="black"></path>
                <path d="M 320,272 L 480,272" fill="none" stroke="black"></path>
                <path d="M 320,336 L 480,336" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="320,256 308,250.4 308,261.6" fill="black" transform="rotate(0,312,256)"></polygon>
                <polygon class="arrowhead" points="264,144 252,138.4 252,149.6" fill="black" transform="rotate(0,256,144)"></polygon>
                <polygon class="arrowhead" points="192,256 180,250.4 180,261.6" fill="black" transform="rotate(180,184,256)"></polygon>
                <polygon class="arrowhead" points="160,232 148,226.4 148,237.6" fill="black" transform="rotate(90,152,232)"></polygon>
                <polygon class="arrowhead" points="88,232 76,226.4 76,237.6" fill="black" transform="rotate(90,80,232)"></polygon>
                <polygon class="arrowhead" points="88,104 76,98.4 76,109.6" fill="black" transform="rotate(270,80,104)"></polygon>
                <g class="text">
                  <text x="48" y="52">PKCS#10</text>
                  <text x="120" y="52">Attribute</text>
                  <text x="76" y="68">or</text>
                  <text x="36" y="84">CRMF</text>
                  <text x="96" y="84">Extension</text>
                  <text x="56" y="116">1</text>
                  <text x="228" y="132">1..n</text>
                  <text x="348" y="148">CertificateChoices</text>
                  <text x="320" y="180">Certificate</text>
                  <text x="380" y="180">OR</text>
                  <text x="364" y="196">OtherCertificateFormat</text>
                  <text x="56" y="212">1</text>
                  <text x="136" y="228">1</text>
                  <text x="192" y="244">1</text>
                  <text x="284" y="244">1..n</text>
                  <text x="84" y="260">EvidenceBundle</text>
                  <text x="400" y="260">EvidenceStatement</text>
                  <text x="348" y="292">Type</text>
                  <text x="368" y="308">Statement</text>
                  <text x="348" y="324">Hint</text>
                </g>
              </svg><a href="#section-4.1-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-information-model-for-csr-e" class="selfRef">Information Model for CSR Evidence Conveyance.</a>
          </figcaption></figure>
</div>
<p id="section-4.1-5">A conformant implementation of an entity processing the CSR structures <span class="bcp14">MUST</span> be prepared
to use certificates found in the EvidenceBundle structure to build a certification
path to validate any EvidenceStatement.
The following use cases are supported, as described in the sub-sections below.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<div id="case-1-evidence-bundle-without-certificate-chain">
<section id="section-4.1.1">
          <h4 id="name-case-1-evidence-bundle-with">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-case-1-evidence-bundle-with" class="section-name selfRef">Case 1 - Evidence Bundle without Certificate Chain</a>
          </h4>
<p id="section-4.1.1-1">A single Attester, which only distributes Evidence without an attached certificate chain.
In the use case, the Verifier is assumed to be in possession of the certificate chain already
or the Verifier directly trusts the Attestation Key and therefore no certificate chain needs
to be conveyed in the CSR.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">As a result, one EvidenceBundle is included in a CSR that contains a single EvidenceStatement
without the CertificateChoices structure. <a href="#fig-single-attester" class="auto internal xref">Figure 4</a> shows this use case.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<span id="name-case-1-evidence-bundle-witho"></span><div id="fig-single-attester">
<figure id="figure-4">
            <div id="section-4.1.1-3.1">
              <div class="alignLeft art-svg artwork" id="section-4.1.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="184" viewBox="0 0 184 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,96" fill="none" stroke="black"></path>
                  <path d="M 176,32 L 176,96" fill="none" stroke="black"></path>
                  <path d="M 8,32 L 176,32" fill="none" stroke="black"></path>
                  <path d="M 8,96 L 176,96" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="84" y="52">EvidenceBundle</text>
                    <text x="92" y="68">....................</text>
                    <text x="88" y="84">EvidenceStatement</text>
                  </g>
                </svg><a href="#section-4.1.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-case-1-evidence-bundle-witho" class="selfRef">Case 1: Evidence Bundle without Certificate Chain.</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="case-2-evidence-bundle-with-certificate-chain">
<section id="section-4.1.2">
          <h4 id="name-case-2-evidence-bundle-with">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-case-2-evidence-bundle-with" class="section-name selfRef">Case 2 - Evidence Bundle with Certificate Chain</a>
          </h4>
<p id="section-4.1.2-1">A single Attester, which shares Evidence together with a certificate chain, is
shown in <a href="#fig-single-attester-with-path" class="auto internal xref">Figure 5</a>. The CSR conveys an EvidenceBundle
with a single EvidenceStatement and a CertificateChoices structure.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<span id="name-case-2-single-evidence-bund"></span><div id="fig-single-attester-with-path">
<figure id="figure-5">
            <div id="section-4.1.2-2.1">
              <div class="alignLeft art-svg artwork" id="section-4.1.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="144" width="224" viewBox="0 0 224 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,112" fill="none" stroke="black"></path>
                  <path d="M 216,32 L 216,112" fill="none" stroke="black"></path>
                  <path d="M 8,32 L 216,32" fill="none" stroke="black"></path>
                  <path d="M 8,112 L 216,112" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="84" y="52">EvidenceBundle</text>
                    <text x="112" y="68">.........................</text>
                    <text x="88" y="84">EvidenceStatement</text>
                    <text x="92" y="100">CertificateChoices</text>
                  </g>
                </svg><a href="#section-4.1.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-case-2-single-evidence-bund" class="selfRef">Case 2: Single Evidence Bundle with Certificate Chain.</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="case-3-evidence-bundles-with-multiple-evidence-statements-and-complete-certificate-chains">
<section id="section-4.1.3">
          <h4 id="name-case-3-evidence-bundles-wit">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-case-3-evidence-bundles-wit" class="section-name selfRef">Case 3 - Evidence Bundles with Multiple Evidence Statements and Complete Certificate Chains</a>
          </h4>
<p id="section-4.1.3-1">In a Composite Device, which contains multiple Attesters, a collection of Evidence
statements is obtained. In this use case, each Attester returns its Evidence together with a
certificate chain. As a result, multiple EvidenceStatement structures and the corresponding CertificateChoices structure with the
certification chains as provided by the Attester, are included in the CSR.
This approach does not require any processing capabilities
by a Lead Attester since the information is merely forwarded. <a href="#fig-multiple-attesters" class="auto internal xref">Figure 6</a>
shows this use case.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<span id="name-case-3-multiple-evidence-st"></span><div id="fig-multiple-attesters">
<figure id="figure-6">
            <div id="section-4.1.3-2.1">
              <div class="alignLeft art-svg artwork" id="section-4.1.3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="160" width="560" viewBox="0 0 560 160" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,128" fill="none" stroke="black"></path>
                  <path d="M 216,32 L 216,128" fill="none" stroke="black"></path>
                  <path d="M 8,32 L 216,32" fill="none" stroke="black"></path>
                  <path d="M 8,128 L 216,128" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="84" y="52">EvidenceBundle</text>
                    <text x="112" y="68">.........................</text>
                    <text x="88" y="84">EvidenceStatement</text>
                    <text x="176" y="84">(1)</text>
                    <text x="260" y="84">Provided</text>
                    <text x="308" y="84">by</text>
                    <text x="356" y="84">Attester</text>
                    <text x="400" y="84">1</text>
                    <text x="88" y="100">EvidenceStatement</text>
                    <text x="176" y="100">(2)</text>
                    <text x="260" y="100">Provided</text>
                    <text x="308" y="100">by</text>
                    <text x="356" y="100">Attester</text>
                    <text x="400" y="100">2</text>
                    <text x="92" y="116">CertificateChoices</text>
                    <text x="276" y="116">Certificates</text>
                    <text x="364" y="116">provided</text>
                    <text x="412" y="116">by</text>
                    <text x="460" y="116">Attester</text>
                    <text x="504" y="116">1</text>
                    <text x="528" y="116">and</text>
                    <text x="552" y="116">2</text>
                  </g>
                </svg><a href="#section-4.1.3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-case-3-multiple-evidence-st" class="selfRef">Case 3: Multiple Evidence Structures each with Complete Certificate Chains.</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="model-for-attestation-result-in-csr">
<section id="section-4.2">
        <h3 id="name-model-for-attestation-resul">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-model-for-attestation-resul" class="section-name selfRef">Model for Attestation Result in CSR</a>
        </h3>
<p id="section-4.2-1"><a href="#fig-info-model-ar" class="auto internal xref">Figure 7</a> illustrates the information model for transmitting
Attestation Results as a PKCS#10 attribute or a CRMF extension. This
structure includes a single AttestationResultBundle, which in turn comprises
one or more AttestationResult structures.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span id="name-information-model-for-csr-a"></span><div id="fig-info-model-ar">
<figure id="figure-7">
          <div id="section-4.2-2.1">
            <div class="alignLeft art-svg artwork" id="section-4.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="448" viewBox="0 0 448 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,96" fill="none" stroke="black"></path>
                <path d="M 8,240 L 8,272" fill="none" stroke="black"></path>
                <path d="M 80,104 L 80,232" fill="none" stroke="black"></path>
                <path d="M 160,144 L 160,232" fill="none" stroke="black"></path>
                <path d="M 168,32 L 168,96" fill="none" stroke="black"></path>
                <path d="M 216,240 L 216,272" fill="none" stroke="black"></path>
                <path d="M 280,112 L 280,208" fill="none" stroke="black"></path>
                <path d="M 440,112 L 440,208" fill="none" stroke="black"></path>
                <path d="M 8,32 L 168,32" fill="none" stroke="black"></path>
                <path d="M 8,96 L 168,96" fill="none" stroke="black"></path>
                <path d="M 280,112 L 440,112" fill="none" stroke="black"></path>
                <path d="M 160,144 L 440,144" fill="none" stroke="black"></path>
                <path d="M 280,208 L 440,208" fill="none" stroke="black"></path>
                <path d="M 8,240 L 216,240" fill="none" stroke="black"></path>
                <path d="M 8,272 L 216,272" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="280,144 268,138.4 268,149.6" fill="black" transform="rotate(0,272,144)"></polygon>
                <polygon class="arrowhead" points="168,232 156,226.4 156,237.6" fill="black" transform="rotate(90,160,232)"></polygon>
                <polygon class="arrowhead" points="88,232 76,226.4 76,237.6" fill="black" transform="rotate(90,80,232)"></polygon>
                <polygon class="arrowhead" points="88,104 76,98.4 76,109.6" fill="black" transform="rotate(270,80,104)"></polygon>
                <g class="text">
                  <text x="48" y="52">PKCS#10</text>
                  <text x="120" y="52">Attribute</text>
                  <text x="76" y="68">or</text>
                  <text x="36" y="84">CRMF</text>
                  <text x="96" y="84">Extension</text>
                  <text x="56" y="116">1</text>
                  <text x="236" y="132">1..n</text>
                  <text x="360" y="132">AttestationResult</text>
                  <text x="308" y="164">Type</text>
                  <text x="316" y="180">Result</text>
                  <text x="56" y="212">1</text>
                  <text x="144" y="228">1</text>
                  <text x="112" y="260">AttestationResultBundle</text>
                </g>
              </svg><a href="#section-4.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-information-model-for-csr-a" class="selfRef">Information Model for CSR Attestation Result Conveyance.</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="asn1-elements-for-evidence-in-csr">
<section id="section-5">
      <h2 id="name-asn1-elements-for-evidence-">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-asn1-elements-for-evidence-" class="section-name selfRef">ASN.1 Elements for Evidence in CSR</a>
      </h2>
<div id="object-identifiers">
<section id="section-5.1">
        <h3 id="name-object-identifiers">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-object-identifiers" class="section-name selfRef">Object Identifiers</a>
        </h3>
<p id="section-5.1-1">This document references <code>id-pkix</code> and <code>id-aa</code>, both defined in <span>[<a href="#RFC5911" class="cite xref">RFC5911</a>]</span> and <span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">This document defines the arc depicted in <a href="#code-ata-arc" class="auto internal xref">Figure 8</a>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<span id="name-new-oid-arc-for-pkix-eviden"></span><div id="code-ata-arc">
<figure id="figure-8">
          <div class="alignLeft art-text artwork" id="section-5.1-3.1">
<pre>
-- Arc for Evidence types
id-ata OBJECT IDENTIFIER ::= { id-aa (TBD1) }
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-new-oid-arc-for-pkix-eviden" class="selfRef">New OID Arc for PKIX Evidence Statement Formats</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-evidenceAttr">
<section id="section-5.2">
        <h3 id="name-evidence-attribute-and-exte">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-evidence-attribute-and-exte" class="section-name selfRef">Evidence Attribute and Extension</a>
        </h3>
<p id="section-5.2-1">By definition, attributes within a PKCS#10 CSR are
typed as ATTRIBUTE and within a CRMF CSR are typed as EXTENSION.
This attribute definition contains one
Evidence bundle of type <code>EvidenceBundle</code> containing
one or more Evidence statements of a type <code>EvidenceStatement</code> along with
optional certificates for certification path building.
This structure enables different Evidence statements to share a
certification path without duplicating it in the attribute.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span id="name-definition-of-evidencestate"></span><div id="code-EvidenceStatementSet">
<figure id="figure-9">
          <div class="alignLeft art-text artwork" id="section-5.2-2.1">
<pre>
EVIDENCE-STATEMENT ::= TYPE-IDENTIFIER

EvidenceStatementSet EVIDENCE-STATEMENT ::= {
   ... -- None defined in this document --
}
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-definition-of-evidencestate" class="selfRef">Definition of EvidenceStatementSet</a>
          </figcaption></figure>
</div>
<p id="section-5.2-3">The expression illustrated in <a href="#code-EvidenceStatementSet" class="auto internal xref">Figure 9</a> maps ASN.1 Types
for Evidence Statements to the OIDs
that identify them. These mappings are used to construct
or parse EvidenceStatements. Evidence Statements are typically
defined in other IETF standards, other standards bodies,
or vendor proprietary formats along with corresponding OIDs that identify them.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">This list is left unconstrained in this document. However, implementers can
populate it with the formats that they wish to support.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<span id="name-definition-of-evidencestatem"></span><div id="code-EvidenceStatement">
<figure id="figure-10">
          <div class="alignLeft art-text artwork" id="section-5.2-5.1">
<pre>
EvidenceStatement ::= SEQUENCE {
   type   EVIDENCE-STATEMENT.&amp;id({EvidenceStatementSet}),
   stmt   EVIDENCE-STATEMENT.&amp;Type({EvidenceStatementSet}{@type}),
   hint   UTF8String OPTIONAL
}
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-definition-of-evidencestatem" class="selfRef">Definition of EvidenceStatement</a>
          </figcaption></figure>
</div>
<p id="section-5.2-6">In <a href="#code-EvidenceStatement" class="auto internal xref">Figure 10</a>, type is an OID that indicates the format of the value of stmt.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">Based on the responsibilities of the different roles in the RATS architecture,
Relying Parties need to relay Evidence to Verifiers for evaluation and obtain
an Attestation Result in return. Ideally, the Relying Party should select a Verifier
based on the received Evidence without requiring the Relying Party to inspect the
Evidence itself. This "routing" decision is simple when there is only a single
Verifier configured for use by a Relying Party but gets more complex when there
are different Verifiers available and each of them capable of parsing only certain
Evidence formats.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">In some cases, the EvidenceStatement.type OID will be sufficient information
for the Relying Party to correctly route it to an appropriate Verifier,
however since the type OID only identifies the general data format, it is possible
that multiple Verifiers are registered against the same type OID in which case the
Relying Party will either require additional parsing of the evidence statement, or
the Attester will be required to provide additional information.<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<p id="section-5.2-9">To simplify the task for the Relying Party an optional field, the hint, is available
in the EvidenceStatement structure, as shown in <a href="#code-EvidenceStatement" class="auto internal xref">Figure 10</a>. An
Attester <span class="bcp14">MAY</span> include the hint to the EvidenceStatement and it <span class="bcp14">MAY</span> be processed
by the Relying Party. The Relying Party <span class="bcp14">MAY</span> decide not to trust the information
embedded in the hint or policy <span class="bcp14">MAY</span> override any information provided by the Attester
via this hint.<a href="#section-5.2-9" class="pilcrow">¶</a></p>
<p id="section-5.2-10">When the Attester populates the hint, it <span class="bcp14">MUST</span> contain a fully qualified domain
name (FQDN) which uniquely identifies a Verifier.
The problem of mapping hint FQDNs to Verifiers, and the problem of FQDN collision
is out of scope for this specification; it is assumed that Attester and Verifier
makers can manage this appropriately on their own FQDN trees, however if this
becomes problematic then a public registry may be needed.<a href="#section-5.2-10" class="pilcrow">¶</a></p>
<p id="section-5.2-11">In a typical usage scenario, the Relying Party is pre-configured with
a list of trusted Verifiers and the corresponding hint values can be used to look
up appropriate Verifier. Tricking an Relying Party into interacting with an unknown
and untrusted Verifier must be avoided.<a href="#section-5.2-11" class="pilcrow">¶</a></p>
<p id="section-5.2-12">Usage of the hint field can be seen in the TPM2_attest example in
<a href="#appdx-tpm2" class="auto internal xref">Appendix A.2</a> where the type OID indicates the OID
id-TcgAttestCertify and the corresponding hint identifies the Verifier as
"tpmverifier.example.com".<a href="#section-5.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-13">
<pre>
EvidenceBundle ::= SEQUENCE {
   evidences SEQUENCE SIZE (1..MAX) OF EvidenceStatement,
   certs SEQUENCE SIZE (1..MAX) OF CertificateChoices OPTIONAL
      -- CertificateChoices MUST only contain certificate or other,
      -- see Section 10.2.2 of [RFC5652]
}
</pre><a href="#section-5.2-13" class="pilcrow">¶</a>
</div>
<p id="section-5.2-14">The CertificateChoices structure defined in <span>[<a href="#RFC6268" class="cite xref">RFC6268</a>]</span> allows for carrying certificates in the default X.509 <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> format, or in other non-X.509 certificate formats. CertificateChoices <span class="bcp14">MUST</span> only contain certificate or other. CertificateChoices <span class="bcp14">MUST NOT</span> contain extendedCertificate, v1AttrCert, or v2AttrCert. Note that for non-ASN.1 certificate formats, the CertificateChoices <span class="bcp14">MUST</span> use <code>other [3]</code> with an <code>OtherCertificateFormat.Type</code> of <code>OCTET STRING</code>, and then can carry any binary data.<a href="#section-5.2-14" class="pilcrow">¶</a></p>
<p id="section-5.2-15">The <code>certs</code> field contains a set of certificates that
is intended to validate the contents of an Evidence statement
contained in <code>evidences</code>, if required. For each Evidnece statement the set of certificates should contain
the certificate that contains the public key needed to directly validate the
Evidence statement. Additional certificates may be provided, for example, to chain the
Evidence signer key back to an agreed upon trust anchor. No specific order of the certificates in <code>certs</code> <span class="bcp14">SHOULD</span> be expected because certificates contained in <code>certs</code> may be needed to validate different Evidence statements.<a href="#section-5.2-15" class="pilcrow">¶</a></p>
<p id="section-5.2-16">This specification places no restriction on mixing certificate types within the <code>certs</code> field. For example a non-X.509 Evidence signer certificate <span class="bcp14">MAY</span> chain to a trust anchor via a chain of X.509 certificates. It is up to the Attester and its Verifier to agree on supported certificate formats.<a href="#section-5.2-16" class="pilcrow">¶</a></p>
<span id="name-definitions-of-csr-attribut"></span><div id="code-extensions">
<figure id="figure-11">
          <div class="alignLeft art-text artwork" id="section-5.2-17.1">
<pre>
id-aa-evidence OBJECT IDENTIFIER ::= { id-ata 59 }

-- For PKCS#10
attr-evidence ATTRIBUTE ::= {
  TYPE EvidenceBundle
  COUNTS MAX 1
  IDENTIFIED BY id-aa-evidence
}

-- For CRMF
ext-evidence EXTENSION ::= {
  SYNTAX EvidenceBundle
  IDENTIFIED BY id-aa-evidence
}
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-definitions-of-csr-attribut" class="selfRef">Definitions of CSR attribute and extension</a>
          </figcaption></figure>
</div>
<p id="section-5.2-18">The Extension variant illustrated in <a href="#code-extensions" class="auto internal xref">Figure 11</a> is intended only for use within CRMF CSRs and is <span class="bcp14">NOT RECOMMENDED</span> to be used within X.509 certificates due to the privacy implications of publishing Evidence about the end entity's hardware environment. See <a href="#sec-con-publishing-x509" class="auto internal xref">Section 8.3</a> for more discussion.<a href="#section-5.2-18" class="pilcrow">¶</a></p>
<p id="section-5.2-19">By the nature of the PKIX ASN.1 classes <span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span>, there are multiple ways to convey multiple Evidence statements: by including multiple copies of <code>attr-evidence</code> or <code>ext-evidence</code>, multiple values within the attribute or extension, and finally, by including multiple <code>EvidenceStatement</code> structures within an <code>EvidenceBundle</code>. The latter is the preferred way to carry multiple Evidence statements. Implementations <span class="bcp14">MUST NOT</span> place multiple copies of <code>attr-evidence</code> into a PKCS#10 CSR due to the <code>COUNTS MAX 1</code> declaration. In a CRMF CSR, implementers <span class="bcp14">SHOULD NOT</span> place multiple copies of <code>ext-evidence</code>.<a href="#section-5.2-19" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="asn1-elements-for-attestation-result-in-csr">
<section id="section-6">
      <h2 id="name-asn1-elements-for-attestati">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-asn1-elements-for-attestati" class="section-name selfRef">ASN.1 Elements for Attestation Result in CSR</a>
      </h2>
<div id="object-identifiers-1">
<section id="section-6.1">
        <h3 id="name-object-identifiers-2">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-object-identifiers-2" class="section-name selfRef">Object Identifiers</a>
        </h3>
<p id="section-6.1-1">This document defines the arc depicted in <a href="#code-ar-arc" class="auto internal xref">Figure 12</a>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<span id="name-new-oid-arc-for-pkix-attest"></span><div id="code-ar-arc">
<figure id="figure-12">
          <div class="alignLeft art-text artwork" id="section-6.1-2.1">
<pre>
-- Arc for Attestation Result types
id-aa-ar OBJECT IDENTIFIER ::= { id-ata (TBD2) }
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-new-oid-arc-for-pkix-attest" class="selfRef">New OID Arc for PKIX Attestation Result Formats</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-arAttr">
<section id="section-6.2">
        <h3 id="name-attestation-result-attribut">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-attestation-result-attribut" class="section-name selfRef">Attestation Result Attribute and Extension</a>
        </h3>
<p id="section-6.2-1">By definition, attributes within a PKCS#10 CSR are
typed as ATTRIBUTE and within a CRMF CSR are typed as EXTENSION.
This attribute definition contains one AttestationResultBundle structure.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<span id="name-definition-of-attestationre"></span><div id="code-AttestationResultSet">
<figure id="figure-13">
          <div class="alignLeft art-text artwork" id="section-6.2-2.1">
<pre>
ATTESTATION-RESULT ::= TYPE-IDENTIFIER

AttestationResultSet ATTESTATION-RESULT ::= {
   ... -- None defined in this document --
}
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-definition-of-attestationre" class="selfRef">Definition of AttestationResultSet</a>
          </figcaption></figure>
</div>
<p id="section-6.2-3">The expression illustrated in <a href="#code-AttestationResultSet" class="auto internal xref">Figure 13</a>
maps ASN.1 Types for Attestation Result to the OIDs that identify them. These
mappings are used to construct or parse AttestationResults. Attestation Results
are defined in other IETF standards (see <span>[<a href="#I-D.ietf-rats-ar4si" class="cite xref">I-D.ietf-rats-ar4si</a>]</span>),
other standards bodies, or vendor proprietary formats along with corresponding
OIDs that identify them.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">This list is left unconstrained in this document. However, implementers can
populate it with the formats that they wish to support.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<span id="name-definition-of-attestationres"></span><div id="code-AttestationResult">
<figure id="figure-14">
          <div class="alignLeft art-text artwork" id="section-6.2-5.1">
<pre>
AttestationResult ::= SEQUENCE {
   type   ATTESTATION-RESULT.&amp;id({AttestationResultSet}),
   stmt   ATTESTATION-RESULT.&amp;Type({AttestationResultSet}{@type}),
}
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-definition-of-attestationres" class="selfRef">Definition of AttestationResult</a>
          </figcaption></figure>
</div>
<p id="section-6.2-6">In <a href="#code-AttestationResult" class="auto internal xref">Figure 14</a>, type is an OID that indicates the format of the
value of stmt.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-7">
<pre>
AttestationResultBundle ::= SEQUENCE SIZE (1..MAX) OF AttestationResult
</pre><a href="#section-6.2-7" class="pilcrow">¶</a>
</div>
<span id="name-definitions-of-csr-attribute"></span><div id="code-extensions-ar">
<figure id="figure-15">
          <div class="alignLeft art-text artwork" id="section-6.2-8.1">
<pre>
id-aa-ar OBJECT IDENTIFIER ::= { id-ata 60 }

-- For PKCS#10
attr-ar ATTRIBUTE ::= {
  TYPE AttestationResultBundle
  COUNTS MAX 1
  IDENTIFIED BY id-aa-ar
}

-- For CRMF
ext-ar EXTENSION ::= {
  SYNTAX AttestationResultBundle
  IDENTIFIED BY id-aa-ar
}
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-definitions-of-csr-attribute" class="selfRef">Definitions of CSR attribute and extension</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-6.3">
        <h3 id="name-implementation-consideratio">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
        </h3>
<p id="section-6.3-1">This specification is applicable both in cases where a CSR
is constructed internally or externally to the Attesting Environment, from the
point of view of the calling application. This section is particularly
applicable to the background check model.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Cases where the CSR is generated internally to the Attesting Environment
are straightforward: the Hardware Security Model (HSM) generates and embeds
the Evidence and the corresponding certification paths when constructing the CSR.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">Cases where the CSR is generated externally may require extra communication
between the CSR generator and the Attesting Environment, first to obtain
the necessary Evidence about the subject key, and then to use
the subject key to sign the CSR; for example, a CSR generated by
a popular crypto library about a subject key stored on a PKCS#11 <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span> device.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">As an example, assuming that the HSM is, or contains, the Attesting Environment and
some cryptographic library is assembling a CSR by interacting with the HSM over some
network protocol, then the interaction would conceptually be:<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<span id="name-example-interaction-between"></span><div id="fig-csr-client-p11">
<figure id="figure-16">
          <div id="section-6.3-5.1">
            <div class="alignLeft art-svg artwork" id="section-6.3-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="384" viewBox="0 0 384 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,176 L 8,208" fill="none" stroke="black"></path>
                <path d="M 160,32 L 160,80" fill="none" stroke="black"></path>
                <path d="M 184,176 L 184,208" fill="none" stroke="black"></path>
                <path d="M 200,88 L 200,304" fill="none" stroke="black"></path>
                <path d="M 240,32 L 240,80" fill="none" stroke="black"></path>
                <path d="M 328,32 L 328,80" fill="none" stroke="black"></path>
                <path d="M 352,88 L 352,304" fill="none" stroke="black"></path>
                <path d="M 376,32 L 376,80" fill="none" stroke="black"></path>
                <path d="M 160,32 L 240,32" fill="none" stroke="black"></path>
                <path d="M 328,32 L 376,32" fill="none" stroke="black"></path>
                <path d="M 160,80 L 240,80" fill="none" stroke="black"></path>
                <path d="M 328,80 L 376,80" fill="none" stroke="black"></path>
                <path d="M 208,128 L 344,128" fill="none" stroke="black"></path>
                <path d="M 208,160 L 344,160" fill="none" stroke="black"></path>
                <path d="M 8,176 L 184,176" fill="none" stroke="black"></path>
                <path d="M 8,208 L 184,208" fill="none" stroke="black"></path>
                <path d="M 208,256 L 344,256" fill="none" stroke="black"></path>
                <path d="M 208,288 L 344,288" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="352,256 340,250.4 340,261.6" fill="black" transform="rotate(0,344,256)"></polygon>
                <polygon class="arrowhead" points="352,128 340,122.4 340,133.6" fill="black" transform="rotate(0,344,128)"></polygon>
                <polygon class="arrowhead" points="216,288 204,282.4 204,293.6" fill="black" transform="rotate(180,208,288)"></polygon>
                <polygon class="arrowhead" points="216,160 204,154.4 204,165.6" fill="black" transform="rotate(180,208,160)"></polygon>
                <g class="text">
                  <text x="196" y="52">Crypto</text>
                  <text x="352" y="52">HSM</text>
                  <text x="200" y="68">Library</text>
                  <text x="264" y="116">getEvidence()</text>
                  <text x="32" y="196">CSR</text>
                  <text x="56" y="196">=</text>
                  <text x="120" y="196">assembleCSR()</text>
                  <text x="192" y="196">-</text>
                  <text x="248" y="244">sign(CSR)</text>
                </g>
              </svg><a href="#section-6.3-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-example-interaction-between" class="selfRef">Example interaction between CSR generator and HSM.</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">IANA is requested to open two new registries, allocate a value
from the "SMI Security for PKIX Module Identifier" registry for the
included ASN.1 module, and allocate values from "SMI Security for
S/MIME Attributes" to identify two attributes defined within.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="module-registration-smi-security-for-pkix-module-identifier">
<section id="section-7.1">
        <h3 id="name-module-registration-smi-sec">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-module-registration-smi-sec" class="section-name selfRef">Module Registration - SMI Security for PKIX Module Identifier</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.1-1.1">
            <p id="section-7.1-1.1.1">Decimal: IANA Assigned - <strong>Replace TBDMOD</strong><a href="#section-7.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.2">
            <p id="section-7.1-1.2.1">Description: CSR-ATTESTATION-2023 - id-mod-pkix-attest-01<a href="#section-7.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.3">
            <p id="section-7.1-1.3.1">References: This Document<a href="#section-7.1-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="object-identifier-registrations-smi-security-for-smime-attributes">
<section id="section-7.2">
        <h3 id="name-object-identifier-registrat">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-object-identifier-registrat" class="section-name selfRef">Object Identifier Registrations - SMI Security for S/MIME Attributes</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.2-1.1">
            <p id="section-7.2-1.1.1">Evidence Statement<a href="#section-7.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.2">
            <p id="section-7.2-1.2.1">Decimal: IANA Assigned - This was early-allocated as <code>59</code> so that we could generate the sample data.<a href="#section-7.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.3">
            <p id="section-7.2-1.3.1">Description: id-aa-evidence<a href="#section-7.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.4">
            <p id="section-7.2-1.4.1">References: This Document<a href="#section-7.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.5">
            <p id="section-7.2-1.5.1">Attestation Result<a href="#section-7.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.6">
            <p id="section-7.2-1.6.1">Decimal: IANA Assigned - - <strong>Replace TBD2</strong><a href="#section-7.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.7">
            <p id="section-7.2-1.7.1">Description: id-aa-ar<a href="#section-7.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.8">
            <p id="section-7.2-1.8.1">References: This Document<a href="#section-7.2-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="smi-security-for-pkix-evidence-statement-formats-registry">
<section id="section-7.3">
        <h3 id="name-smi-security-for-pkix-evide">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-smi-security-for-pkix-evide" class="section-name selfRef">"SMI Security for PKIX Evidence Statement Formats" Registry</a>
        </h3>
<p id="section-7.3-1">IANA is asked to create a registry for Evidence Statement Formats within
the SMI-numbers registry, allocating an assignment from id-pkix ("SMI
Security for PKIX" Registry) for the purpose.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-2.1">
            <p id="section-7.3-2.1.1">Decimal: IANA Assigned - <strong>replace TBD1</strong><a href="#section-7.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.2">
            <p id="section-7.3-2.2.1">Description: id-ata<a href="#section-7.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.3">
            <p id="section-7.3-2.3.1">References: This document<a href="#section-7.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.4">
            <p id="section-7.3-2.4.1">Initial contents: None<a href="#section-7.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.5">
            <p id="section-7.3-2.5.1">Registration Regime: Specification Required.
Document must specify an EVIDENCE-STATEMENT or ATTESTATION-RESULT
definition to which this Object Identifier shall be bound.<a href="#section-7.3-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.3-3">Columns:<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-4.1">
            <p id="section-7.3-4.1.1">Decimal: The subcomponent under id-ata<a href="#section-7.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-4.2">
            <p id="section-7.3-4.2.1">Description: Begins with id-ata<a href="#section-7.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-4.3">
            <p id="section-7.3-4.3.1">References: RFC or other document<a href="#section-7.3-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="attestation-evidence-oid-registry">
<section id="section-7.4">
        <h3 id="name-attestation-evidence-oid-re">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-attestation-evidence-oid-re" class="section-name selfRef">Attestation Evidence OID Registry</a>
        </h3>
<p id="section-7.4-1">IANA is asked to create a registry that helps developers to find
OID/Evidence mappings.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">Registration requests are evaluated using the criteria described in
the registration template below after a three-week review period on
the [[TBD]] mailing list, with the advice of one or more Designated
Experts <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.  However, to allow for the allocation of values
prior to publication, the Designated Experts may approve registration
once they are satisfied that such a specification will be published.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">Registration requests sent to the mailing list for review should use
an appropriate subject (e.g., "Request to register attestation
evidence: example").<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4">IANA must only accept registry updates from the Designated Experts
and should direct all requests for registration to the review mailing
list.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<div id="registration-template">
<section id="section-7.4.1">
          <h4 id="name-registration-template">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-registration-template" class="section-name selfRef">Registration Template</a>
          </h4>
<p id="section-7.4.1-1">The registry has the following columns:<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4.1-2.1">
              <p id="section-7.4.1-2.1.1">OID: The OID number, which has already been allocated. IANA does
not allocate OID numbers for use with this registry.<a href="#section-7.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.1-2.2">
              <p id="section-7.4.1-2.2.1">Description: Brief description of the use of the Evidence and the
registration of the OID.<a href="#section-7.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.1-2.3">
              <p id="section-7.4.1-2.3.1">Reference(s): Reference to the document or documents that register
the OID for use with a specific attestation technology, preferably
including URIs that can be used to retrieve copies of the documents.
An indication of the relevant sections may also be included but is not
required.<a href="#section-7.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.1-2.4">
              <p id="section-7.4.1-2.4.1">Change Controller: For Standards Track RFCs, list the "IESG".  For
others, give the name of the responsible party. In most cases the
third party requesting registration in this registry will also be the
party that registered the OID.<a href="#section-7.4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="initial-registry-contents">
<section id="section-7.4.2">
          <h4 id="name-initial-registry-contents">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-initial-registry-contents" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<p id="section-7.4.2-1">The initial registry contents is shown in the table below.
It lists entries for several evidence encoding OIDs including an entry for the Conceptual Message Wrapper (CMW) <span>[<a href="#I-D.ietf-rats-msg-wrap" class="cite xref">I-D.ietf-rats-msg-wrap</a>]</span>.<a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-att"></span><div id="tab-ae-reg">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-initial-contents-of-the-att" class="selfRef">Initial Contents of the Attestation Evidence OID Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">OID</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
                <th class="text-left" rowspan="1" colspan="1">Reference(s)</th>
                <th class="text-left" rowspan="1" colspan="1">Change Controller</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 5 4 1</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-dice-TcbInfo</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 5 4 3</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-dice-endorsement-manifest-uri</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 5 4 4</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-dice-Ueid</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 5 4 5</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-dice-MultiTcbInfo</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 5 4 6</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-dice-UCCS-evidence</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 5 4 7</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-dice-manifest-evidence</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 5 4 8</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-dice-MultiTcbInfoComp</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 5 4 9</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-dice-conceptual-message-wrapper</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 5 4 11</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-dice-TcbFreshness</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 23 133 20 1</td>
                <td class="text-left" rowspan="1" colspan="1">tcg-attest-tpm-certify</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#TCGRegistry" class="cite xref">TCGRegistry</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">TCG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1 3 6 1 5 5 7 1 35</td>
                <td class="text-left" rowspan="1" colspan="1">id-pe-cmw</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#I-D.ietf-rats-msg-wrap" class="cite xref">I-D.ietf-rats-msg-wrap</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">IETF</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-7.4.2-3">The current registry values can be retrieved from the IANA online website.<a href="#section-7.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">In the RATS architecture, when Evidence or an Attestation Result is presented to a Relying Party (RP), the RP may learn detailed information about the Attester unless that information has been redacted or encrypted. Consequently, a certain amount of trust must be placed in the RP, which raises potential privacy concerns because an RP could be used to track devices. This observation is noted in Section 11 of <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Typically, the RPs considered in the RATS architecture are application services that use remote attestation, rather than RAs or CAs. Devices inherently place significant trust in RA/CA infrastructure elements, and therefore any additional information revealed through remote attestation to such entities is generally less concerning than disclosure to application services. The problem of copying Evidence by CAs into an X.509 certificate is discussed in <a href="#sec-con-publishing-x509" class="auto internal xref">Section 8.3</a>.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">These privacy risks can be mitigated using several approaches, including:<a href="#section-8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-4.1">
          <p id="section-8-4.1.1">Shared Attestation Keys: A manufacturer of devices may provision all devices with the same attestation key(s), or share a common attestation key across devices of the same product family. This approach anonymizes individual devices by making them indistinguishable from others using the same key(s). However, it also means losing the ability to revoke a single attestation key if a specific device is compromised. Care must be taken to avoid embedding uniquely identifying information in the Evidence, as that would reduce the privacy benefits of using remote attestation.<a href="#section-8-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.2">
          <p id="section-8-4.2.1">Per-Use Attestation Keys: Devices may be designed to dynamically generate distinct attestation keys (and request the corresponding certificates) for each use case, device, or session. This is analogous to the Privacy CA model, in which a device is initially provisioned with an attestation key and certificate; then, in conjunction with a privacy-preserving CA, it can obtain unique keys and certificates as needed. This strategy reduces the potential for tracking while maintaining strong security assurances. This is the model described in this document.<a href="#section-8-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.3">
          <p id="section-8-4.3.1">Anonymous Attestation Mechanisms: Direct anonymous attestation (DAA) or similar cryptographic methods can be employed to generate blinded attestation signatures. In these schemes, the verifier can validate the attestation using a root key but does not gain a global correlation handle. Thus, repeated use of the same attestation key cannot be exploited to track devices. <span>[<a href="#I-D.ietf-rats-daa" class="cite xref">I-D.ietf-rats-daa</a>]</span> extends the RATS architecture with such a DAA scheme, significantly enhancing privacy.<a href="#section-8-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="background-check-model-security-considerations">
<section id="section-8.1">
        <h3 id="name-background-check-model-secu">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-background-check-model-secu" class="section-name selfRef">Background Check Model Security Considerations</a>
        </h3>
<p id="section-8.1-1">A PKCS#10 or CRMF Certification Request message typically consists of a
distinguished name, a public key, and optionally a set of attributes,
collectively signed by the entity requesting certification.
In general usage, the private key used to sign the CSR <span class="bcp14">MUST</span> be different from the
Attesting Key utilized to sign Evidence about the Target
Environment, though exceptions <span class="bcp14">MAY</span> be made where CSRs and Evidence are involved in
bootstrapping the Attesting Key.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">To demonstrate that the private
key applied to sign the CSR is generated, and stored in a secure
environment that has controls to prevent theft or misuse (including
being non-exportable / non-recoverable), the Attesting Environment
has to collect claims about this secure environment (or Target
Environment, as shown in <a href="#fig-attester" class="auto internal xref">Figure 17</a>).<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3"><a href="#fig-attester" class="auto internal xref">Figure 17</a> shows the interaction inside an Attester. The
Attesting Environment, which is provisioned with an Attestation Key,
retrieves claims about the Target Environment. The Target
Environment offers key generation, storage and usage, which it
makes available to services. The Attesting Environment collects
these claims about the Target Environment and signs them and
exports Evidence for use in remote attestation via a CSR.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<span id="name-interaction-between-attesti"></span><div id="fig-attester">
<figure id="figure-17">
          <div id="section-8.1-4.1">
            <div class="alignLeft art-svg artwork" id="section-8.1-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="576" width="328" viewBox="0 0 328 576" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,240 L 8,544" fill="none" stroke="black"></path>
                <path d="M 40,80 L 40,144" fill="none" stroke="black"></path>
                <path d="M 48,288 L 48,352" fill="none" stroke="black"></path>
                <path d="M 96,152 L 96,280" fill="none" stroke="black"></path>
                <path d="M 120,152 L 120,280" fill="none" stroke="black"></path>
                <path d="M 120,448 L 120,512" fill="none" stroke="black"></path>
                <path d="M 152,32 L 152,80" fill="none" stroke="black"></path>
                <path d="M 168,352 L 168,440" fill="none" stroke="black"></path>
                <path d="M 200,152 L 200,280" fill="none" stroke="black"></path>
                <path d="M 232,448 L 232,512" fill="none" stroke="black"></path>
                <path d="M 240,280 L 240,352" fill="none" stroke="black"></path>
                <path d="M 264,80 L 264,144" fill="none" stroke="black"></path>
                <path d="M 304,240 L 304,472" fill="none" stroke="black"></path>
                <path d="M 304,488 L 304,544" fill="none" stroke="black"></path>
                <path d="M 320,112 L 320,480" fill="none" stroke="black"></path>
                <path d="M 40,80 L 264,80" fill="none" stroke="black"></path>
                <path d="M 272,112 L 320,112" fill="none" stroke="black"></path>
                <path d="M 40,144 L 264,144" fill="none" stroke="black"></path>
                <path d="M 8,240 L 88,240" fill="none" stroke="black"></path>
                <path d="M 128,240 L 192,240" fill="none" stroke="black"></path>
                <path d="M 208,240 L 304,240" fill="none" stroke="black"></path>
                <path d="M 48,288 L 240,288" fill="none" stroke="black"></path>
                <path d="M 48,352 L 240,352" fill="none" stroke="black"></path>
                <path d="M 120,448 L 232,448" fill="none" stroke="black"></path>
                <path d="M 72,480 L 112,480" fill="none" stroke="black"></path>
                <path d="M 232,480 L 320,480" fill="none" stroke="black"></path>
                <path d="M 120,512 L 232,512" fill="none" stroke="black"></path>
                <path d="M 8,544 L 304,544" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="280,112 268,106.4 268,117.6" fill="black" transform="rotate(180,272,112)"></polygon>
                <polygon class="arrowhead" points="208,280 196,274.4 196,285.6" fill="black" transform="rotate(90,200,280)"></polygon>
                <polygon class="arrowhead" points="208,152 196,146.4 196,157.6" fill="black" transform="rotate(270,200,152)"></polygon>
                <polygon class="arrowhead" points="176,440 164,434.4 164,445.6" fill="black" transform="rotate(90,168,440)"></polygon>
                <polygon class="arrowhead" points="160,32 148,26.4 148,37.6" fill="black" transform="rotate(270,152,32)"></polygon>
                <polygon class="arrowhead" points="128,152 116,146.4 116,157.6" fill="black" transform="rotate(270,120,152)"></polygon>
                <polygon class="arrowhead" points="120,480 108,474.4 108,485.6" fill="black" transform="rotate(0,112,480)"></polygon>
                <polygon class="arrowhead" points="104,280 92,274.4 92,285.6" fill="black" transform="rotate(90,96,280)"></polygon>
                <g class="text">
                  <text x="168" y="52">CSR</text>
                  <text x="204" y="52">with</text>
                  <text x="188" y="68">Evidence</text>
                  <text x="112" y="116">CSR</text>
                  <text x="160" y="116">Library</text>
                  <text x="32" y="180">Private</text>
                  <text x="156" y="180">Public</text>
                  <text x="248" y="180">Signature</text>
                  <text x="16" y="196">Key</text>
                  <text x="144" y="196">Key</text>
                  <text x="248" y="196">Operation</text>
                  <text x="44" y="212">Generation</text>
                  <text x="156" y="212">Export</text>
                  <text x="108" y="244">--</text>
                  <text x="268" y="260">Attester</text>
                  <text x="256" y="276">(HSM)</text>
                  <text x="84" y="308">Target</text>
                  <text x="160" y="308">Environment</text>
                  <text x="80" y="324">(with</text>
                  <text x="120" y="324">key</text>
                  <text x="184" y="324">generation,</text>
                  <text x="88" y="340">storage</text>
                  <text x="136" y="340">and</text>
                  <text x="180" y="340">usage)</text>
                  <text x="128" y="388">Collect</text>
                  <text x="132" y="404">Claims</text>
                  <text x="56" y="468">Attestation</text>
                  <text x="168" y="468">Attesting</text>
                  <text x="48" y="484">Key</text>
                  <text x="176" y="484">Environment</text>
                  <text x="172" y="500">(Firmware)</text>
                  <text x="268" y="500">Evidence</text>
                </g>
              </svg><a href="#section-8.1-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-interaction-between-attesti" class="selfRef">Interaction between Attesting and Target Environment</a>
          </figcaption></figure>
</div>
<p id="section-8.1-5"><a href="#fig-attester" class="auto internal xref">Figure 17</a> places the CSR library outside the Attester, which
is a valid architecture for certificate enrollment.
The CSR library may also be located
inside the trusted computing base. Regardless of the placement
of the CSR library, an Attesting Environment <span class="bcp14">MUST</span> be able to collect
claims about the Target Environment such that statements about
the storage of the keying material can be made.
For the Verifier, the provided Evidence must allow
an assessment to be made whether the key used to sign the CSR
is stored in a secure location and cannot be exported.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<p id="section-8.1-6">Evidence communicated in the attributes and structures defined
in this document are meant to be used in a CSR. It is up to
the Verifier and to the Relying Party (RA/CA) to place as much or
as little trust in this information as dictated by policies.<a href="#section-8.1-6" class="pilcrow">¶</a></p>
<p id="section-8.1-7">This document defines the transport of Evidence of different formats
in a CSR. Some of these encoding formats are based on standards
while others are proprietary formats. A Verifier will need to understand
these formats for matching the received claim values against policies.<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<p id="section-8.1-8">Policies drive the processing of Evidence at the Verifier: the Verifier's
Appraisal Policy for Evidence will often be based on specifications by the manufacturer
of a hardware security module, a regulatory agency, or specified by an
oversight body, such as the CA Browser Forum. The Code-Signing Baseline
Requirements <span>[<a href="#CSBR" class="cite xref">CSBR</a>]</span> document
is an example of such a policy that has
been published by the CA Browser Forum and specifies certain properties,
such as non-exportability, which must be enabled for storing
publicly-trusted code-signing keys. Other
policies influence the decision making at the Relying Party when
evaluating the Attestation Result. The Relying Party is ultimately
responsible for making a decision of what information in the Attestation
Result it will accept. The presence of the attributes defined in this
specification provide the Relying Party with additional assurance about
an Attester. Policies used at the Verifier and the Relying Party are
implementation dependent and out of scope for this document. Whether to
require the use of Evidence in a CSR is out-of-scope for this document.<a href="#section-8.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="freshness-for-the-background-check-model">
<section id="section-8.2">
        <h3 id="name-freshness-for-the-backgroun">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-freshness-for-the-backgroun" class="section-name selfRef">Freshness for the Background Check Model</a>
        </h3>
<p id="section-8.2-1">Evidence generated by an Attester generally needs to be fresh to provide
value to the Verifier since the configuration on the device may change
over time. <span><a href="https://rfc-editor.org/rfc/rfc9334#section-10" class="relref">Section 10</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> discusses different approaches for
providing freshness, including a nonce-based approach, the use of timestamps
and an epoch-based technique. The use of nonces requires that nonce to be provided by
the Relying Party in some protocol step prior to Evidence and CSR generation,
and the use of timestamps requires synchronized clocks which cannot be
guaranteed in all operating environments. Epochs also require an out-of-band
communication channel.
This document leaves the exchange of nonces and other freshness data to
certificate management protocols, see <span>[<a href="#I-D.ietf-lamps-attestation-freshness" class="cite xref">I-D.ietf-lamps-attestation-freshness</a>]</span>.
Developers, operators, and designers of protocols, which embed
Evidence-carrying-CSRs, <span class="bcp14">MUST</span> consider what notion of freshness is
appropriate and available in-context; thus the issue of freshness is
left up to the discretion of protocol designers and implementers.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">In the case of Hardware Security Modules (HSM), the definition of "fresh" is somewhat ambiguous in the context
of CSRs, especially considering that non-automated certificate enrollments
are often asynchronous, and considering the common practice of re-using the
same CSR for multiple certificate renewals across the lifetime of a key.
"Freshness" typically implies both asserting that the data was generated
at a certain point-in-time, as well as providing non-replayability.
Certain use cases may have special properties impacting the freshness
requirements. For example, HSMs are typically designed to not allow downgrade
of private key storage properties; for example if a given key was asserted at
time T to have been generated inside the hardware boundary and to be
non-exportable, then it can be assumed that those properties of that key
will continue to hold into the future.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Note: Freshness is also a concern for remote attestation in the passport model; however, the protocol between the Attester and the Verifier lies outside the scope of this specification.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-con-publishing-x509">
<section id="section-8.3">
        <h3 id="name-publishing-evidence-in-an-x">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-publishing-evidence-in-an-x" class="section-name selfRef">Publishing Evidence in an X.509 Extension</a>
        </h3>
<p id="section-8.3-1">This document specifies an Extension for carrying Evidence in a CRMF Certificate Signing Request (CSR), but it is intentionally <span class="bcp14">NOT RECOMMENDED</span> for a CA to copy the ext-evidence extension into the published certificate.
The reason for this is that certificates are considered public information and the Evidence might contain detailed information about hardware and patch levels of the device on which the private key resides.
The certificate requester has consented to sharing this detailed device information with the CA but might not consent to having these details published.
These privacy considerations are beyond the scope of this document and may require additional signaling mechanisms in the CSR to prevent unintended publication of sensitive information, so we leave it as "<span class="bcp14">NOT RECOMMENDED</span>". Often, the correct layer at which to address this is either in certificate profiles, a Certificate Practice Statement (CPS), or in the protocol or application that carries the CSR to the RA/CA where a flag can be added indicating whether the RA/CA should consider the evidence to be public or private.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="type-oid-and-verifier-hint">
<section id="section-8.4">
        <h3 id="name-type-oid-and-verifier-hint">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-type-oid-and-verifier-hint" class="section-name selfRef">Type OID and verifier hint</a>
        </h3>
<p id="section-8.4-1">The <code>EvidenceStatement</code> includes both a <code>type</code> OID and a free form <code>hint</code> field with which the Attester can provide information to the Relying Party about which Verifier to invoke to parse a given piece of Evidence.
Care should be taken when processing these data since at the time they are used, they are not yet verified. In fact, they are protected by the CSR signature but not by the signature from the Attester and so could be maliciously replaced in some cases.
The authors' intent is that the <code>type</code> OID and <code>hint</code> will allow an RP to select between Verifier with which it has pre-established trust relationships, such as Verifier libraries that have been compiled in to the RP application.
As an example, the <code>hint</code> may take the form of an FQDN to uniquely identify a Verifier implementation, but the RP <span class="bcp14">MUST NOT</span> blindly make network calls to unknown domain names and trust the results.
Implementers should also be cautious around <code>type</code> OID or <code>hint</code> values that cause a short-circuit in the verification logic, such as <code>None</code>, <code>Null</code>, <code>Debug</code>, empty CMW contents, or similar values that could cause the Evidence to appear to be valid when in fact it was not properly checked.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="additional-security-considerations">
<section id="section-8.5">
        <h3 id="name-additional-security-conside">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-additional-security-conside" class="section-name selfRef">Additional Security Considerations</a>
        </h3>
<p id="section-8.5-1">In addition to the security considerations listed here, implementers should be familiar with the security considerations of the specifications on this this depends: PKCS#10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>, CRMF <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>, as well as general security concepts relating to remote attestation; many of these concepts are discussed in <span><a href="https://rfc-editor.org/rfc/rfc9334#section-6" class="relref">Section 6</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, <span><a href="https://rfc-editor.org/rfc/rfc9334#section-7" class="relref">Section 7</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, <span><a href="https://rfc-editor.org/rfc/rfc9334#section-9" class="relref">Section 9</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, <span><a href="https://rfc-editor.org/rfc/rfc9334#section-11" class="relref">Section 11</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, and <span><a href="https://rfc-editor.org/rfc/rfc9334#section-12" class="relref">Section 12</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. Implementers should also be aware of any security considerations relating to the specific Evidence and Attestation Result formats being carried within the CSR.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2986">https://www.rfc-editor.org/rfc/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4211">[RFC4211]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4211">https://www.rfc-editor.org/rfc/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5911">[RFC5911]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME"</span>, <span class="seriesInfo">RFC 5911</span>, <span class="seriesInfo">DOI 10.17487/RFC5911</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5911">https://www.rfc-editor.org/rfc/rfc5911</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5912">https://www.rfc-editor.org/rfc/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6268">[RFC6268]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 6268</span>, <span class="seriesInfo">DOI 10.17487/RFC6268</span>, <time datetime="2011-07" class="refDate">July 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6268">https://www.rfc-editor.org/rfc/rfc6268</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
      <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CSBR">[CSBR]</dt>
        <dd>
<span class="refAuthor">CA/Browser Forum</span>, <span class="refTitle">"Baseline Requirements for Code-Signing Certificates, v.3.7"</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://cabforum.org/uploads/Baseline-Requirements-for-the-Issuance-and-Management-of-Code-Signing.v3.7.pdf">https://cabforum.org/uploads/Baseline-Requirements-for-the-Issuance-and-Management-of-Code-Signing.v3.7.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.bft-rats-kat">[I-D.bft-rats-kat]</dt>
        <dd>
<span class="refAuthor">Brossard, M.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">H. Birkholz</span>, <span class="refTitle">"An EAT-based Key Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bft-rats-kat-05</span>, <time datetime="2024-11-21" class="refDate">21 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-05">https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ffm-rats-cca-token">[I-D.ffm-rats-cca-token]</dt>
        <dd>
<span class="refAuthor">Frost, S.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">G. Mandyam</span>, <span class="refTitle">"Arm's Confidential Compute Architecture Reference Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ffm-rats-cca-token-00</span>, <time datetime="2024-07-04" class="refDate">4 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ffm-rats-cca-token-00">https://datatracker.ietf.org/doc/html/draft-ffm-rats-cca-token-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-attestation-freshness">[I-D.ietf-lamps-attestation-freshness]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span> and <span class="refAuthor">H. Brockhaus</span>, <span class="refTitle">"Nonce-based Freshness for Remote Attestation in Certificate Signing Requests (CSRs) for the Certification Management Protocol (CMP) and for Enrollment over Secure Transport (EST)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-attestation-freshness-03</span>, <time datetime="2024-11-05" class="refDate">5 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-attestation-freshness-03">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-attestation-freshness-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-ar4si">[I-D.ietf-rats-ar4si]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Hardjono, T.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">V. Scarlata</span>, <span class="refTitle">"Attestation Results for Secure Interactions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-ar4si-08</span>, <time datetime="2025-02-06" class="refDate">6 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-08">https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-daa">[I-D.ietf-rats-daa]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Newton, C.</span>, <span class="refAuthor">Chen, L.</span>, and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Direct Anonymous Attestation for the Remote Attestation Procedures Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-daa-06</span>, <time datetime="2024-09-05" class="refDate">5 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-daa-06">https://datatracker.ietf.org/doc/html/draft-ietf-rats-daa-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-msg-wrap">[I-D.ietf-rats-msg-wrap]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Smith, N.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">D. Glaze</span>, <span class="refTitle">"RATS Conceptual Messages Wrapper (CMW)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-msg-wrap-11</span>, <time datetime="2024-11-15" class="refDate">15 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-11">https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-tpm-based-network-device-attest">[I-D.ietf-rats-tpm-based-network-device-attest]</dt>
        <dd>
<span class="refAuthor">Fedorkow, G.</span>, <span class="refAuthor">Voit, E.</span>, and <span class="refAuthor">J. Fitzgerald-McKay</span>, <span class="refTitle">"TPM-based Network Device Remote Integrity Verification"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-tpm-based-network-device-attest-14</span>, <time datetime="2022-03-22" class="refDate">22 March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-tpm-based-network-device-attest-14">https://datatracker.ietf.org/doc/html/draft-ietf-rats-tpm-based-network-device-attest-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tschofenig-rats-psa-token">[I-D.tschofenig-rats-psa-token]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Frost, S.</span>, <span class="refAuthor">Brossard, M.</span>, <span class="refAuthor">Shaw, A. L.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Arm's Platform Security Architecture (PSA) Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tschofenig-rats-psa-token-24</span>, <time datetime="2024-09-23" class="refDate">23 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tschofenig-rats-psa-token-24">https://datatracker.ietf.org/doc/html/draft-tschofenig-rats-psa-token-24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PKCS11">[PKCS11]</dt>
        <dd>
<span class="refAuthor">OASIS</span>, <span class="refTitle">"PKCS #11 Cryptographic Token Interface Base Specification Version 2.40"</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.html">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7030">[RFC7030]</dt>
        <dd>
<span class="refAuthor">Pritikin, M., Ed.</span>, <span class="refAuthor">Yee, P., Ed.</span>, and <span class="refAuthor">D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7030">https://www.rfc-editor.org/rfc/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SampleData">[SampleData]</dt>
        <dd>
<span class="refTitle">"CSR Attestation Sample Data"</span>, <span>n.d.</span>, <span>&lt;<a href="https://github.com/lamps-wg/csr-attestation-examples">https://github.com/lamps-wg/csr-attestation-examples</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCGDICE1.1">[TCGDICE1.1]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"DICE Attestation Architecture"</span>, <time datetime="2024-01" class="refDate">January 2024</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/DICE-Attestation-Architecture-Version-1.1-Revision-18_pub.pdf">https://trustedcomputinggroup.org/wp-content/uploads/DICE-Attestation-Architecture-Version-1.1-Revision-18_pub.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCGRegistry">[TCGRegistry]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG OID Registry"</span>, <time datetime="2024-10" class="refDate">October 2024</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tcg-oid-registry/">https://trustedcomputinggroup.org/resource/tcg-oid-registry/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM20">[TPM20]</dt>
      <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Trusted Platform Module Library Specification, Family 2.0"</span>, <span>n.d.</span>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">https://trustedcomputinggroup.org/resource/tpm-library-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">This section provides several examples and sample data for embedding Evidence
in CSRs. The first example embeds Evidence produced by a TPM in the CSR.
The second example conveys an Arm Platform Security Architecture token,
which provides claims about the used hardware and software platform,
into the CSR.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">After publication of this document, additional examples and sample data will
be collected at the following GitHub repository <span>[<a href="#SampleData" class="cite xref">SampleData</a>]</span>:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">https://github.com/lamps-wg/csr-attestation-examples<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<div id="extending-evidencestatementset">
<section id="appendix-A.1">
        <h3 id="name-extending-evidencestatement">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-extending-evidencestatement" class="section-name selfRef">Extending EvidenceStatementSet</a>
        </h3>
<p id="appendix-A.1-1">As defined in <a href="#sec-evidenceAttr" class="auto internal xref">Section 5.2</a>, EvidenceStatementSet acts as a way to provide an ASN.1 compiler or
runtime parser with a list of OBJECT IDENTIFIERs that are known to represent EvidenceStatements
-- and are expected to appear in an EvidenceStatement.type field, along with
the ASN.1 type that should be used to parse the data in the associated EvidenceStatement.stmt field.
Essentially this is a mapping of OIDs to data structures. Implementers are expected to populate it
with mappings for the Evidence types that their application will be handling.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">This specification aims to be agnostic about the type of data being carried, and therefore
does not specify any mandatory-to-implement Evidence types.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">As an example of how to populate EvidenceStatementSet, implementing the TPM 2.0 and PSA Evidence types
given below would result in the following EvidenceStatementSet definition:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4">
<pre>
EvidenceStatementSet EVIDENCE-STATEMENT ::= {
  --- TPM 2.0
  { Tcg-attest-tpm-certify IDENTIFIED BY tcg-attest-tpm-certify },
  ...,

  --- PSA
  { OCTET STRING IDENTIFIED BY { 1 3 6 1 5 5 7 1 99 } }
}
</pre><a href="#appendix-A.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="appdx-tpm2">
<section id="appendix-A.2">
        <h3 id="name-tpm-v20-evidence-in-csr">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-tpm-v20-evidence-in-csr" class="section-name selfRef">TPM V2.0 Evidence in CSR</a>
        </h3>
<p id="appendix-A.2-1">This section describes TPM2 key attestation for use in a CSR.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">This is a complete and canonical example that can be used to test parsers implemented against this specification. Readers who wish the sample data may skip to <a href="#appdx-tpm-example" class="auto internal xref">Appendix A.2.6</a>; the following sections explain the TPM-specific data structures needed to fully parse the contents of the evidence statement.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<div id="tcg-key-attestation-certify">
<section id="appendix-A.2.1">
          <h4 id="name-tcg-key-attestation-certify">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-tcg-key-attestation-certify" class="section-name selfRef">TCG Key Attestation Certify</a>
          </h4>
<p id="appendix-A.2.1-1">There are several ways in TPM2 to provide proof of a key's properties.
(i.e., key attestation). This description uses the simplest and most generally
expected to be used, which is the TPM2_Certify and the TPM2_ReadPublic commands.<a href="#appendix-A.2.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.1-2">This example does not describe how platform attestation augments key attestation.
The properties of the key (such as the name of the key, the key usage) in this example
do not change during the lifetime of the key.<a href="#appendix-A.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tcg-oids">
<section id="appendix-A.2.2">
          <h4 id="name-tcg-oids">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-tcg-oids" class="section-name selfRef">TCG OIDs</a>
          </h4>
<p id="appendix-A.2.2-1">The OIDs in this section are defined by TCG
TCG has a registered arc of 2.23.133<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.2-2">
<pre>
tcg OBJECT IDENTIFIER ::= { 2 23 133 }

tcg-kp-AIKCertificate OBJECT IDENTIFIER ::= { id-tcg 8 3 }

tcg-attest OBJECT IDENTIFIER ::= { tcg 20 }

tcg-attest-tpm-certify OBJECT IDENTIFIER ::= { tcg-attest 1 }
</pre><a href="#appendix-A.2.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-3">The tcg-kp-AIKCertificate OID in extendedKeyUsage identifies an AK Certificate in RFC 5280 format defined by TCG. This
certificate would be a certificate in the EvidenceBundle defined in <a href="#sec-evidenceAttr" class="auto internal xref">Section 5.2</a>. (Note: The abbreviation AIK was used in
TPM 1.2 specification. TPM 2.0 specifications use the abbreviation AK. The abbreviations are interchangeable.)<a href="#appendix-A.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="appdx-tcg-attest-tpm-certify">
<section id="appendix-A.2.3">
          <h4 id="name-tpm2-attestationstatement">
<a href="#appendix-A.2.3" class="section-number selfRef">A.2.3. </a><a href="#name-tpm2-attestationstatement" class="section-name selfRef">TPM2 AttestationStatement</a>
          </h4>
<p id="appendix-A.2.3-1">The EvidenceStatement structure contains a sequence of two fields:
a type and a stmt. The 'type' field contains the OID of the Evidence format and it is
set to tcg-attest-tpm-certify. The content of the structure shown below is placed into
the stmt, which is a concatenation of existing TPM2 structures. These structures
will be explained in the rest of this section.<a href="#appendix-A.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.3-2">
<pre>
Tcg-csr-tpm-certify ::= SEQUENCE {
  tpmSAttest       OCTET STRING,
  signature        OCTET STRING,
  tpmTPublic       OCTET STRING OPTIONAL
}
</pre><a href="#appendix-A.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="introduction-to-tpm2-concepts">
<section id="appendix-A.2.4">
          <h4 id="name-introduction-to-tpm2-concep">
<a href="#appendix-A.2.4" class="section-number selfRef">A.2.4. </a><a href="#name-introduction-to-tpm2-concep" class="section-name selfRef">Introduction to TPM2 concepts</a>
          </h4>
<p id="appendix-A.2.4-1">The definitions in the following sections are specified by the Trusted Computing Group (TCG). TCG specification including the TPM2 set of specifications <span>[<a href="#TPM20" class="cite xref">TPM20</a>]</span>, specifically Part 2 defines the TPM 2.0 structures.
Those familiar with TPM2 concepts may skip to <a href="#appdx-tcg-attest-tpm-certify" class="auto internal xref">Appendix A.2.3</a> which defines an ASN.1 structure
specific for bundling a TPM attestation into an EvidenceStatement, and <a href="#appdx-tpm-example" class="auto internal xref">Appendix A.2.6</a> which provides the example.
For those unfamiliar with TPM2 concepts this section provides only the minimum information to understand TPM2
Attestation in CSR and is not a complete description of the technology in general.<a href="#appendix-A.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tcg-objects-and-key-attestation">
<section id="appendix-A.2.5">
          <h4 id="name-tcg-objects-and-key-attesta">
<a href="#appendix-A.2.5" class="section-number selfRef">A.2.5. </a><a href="#name-tcg-objects-and-key-attesta" class="section-name selfRef">TCG Objects and Key Attestation</a>
          </h4>
<p id="appendix-A.2.5-1">This provides a brief explanation of the relevant TPM2 commands and data
structures needed to understand TPM2 Attestation used in this RFC.
NOTE: The TPM2 specification used in this explanation is version 1.59,
section number cited are based on that version. Note also that the TPM2
specification comprises four documents: Part 1: Architecture; Part 2: Structures;
Part 3: Commands; Part 4: Supporting Routines.<a href="#appendix-A.2.5-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.5-2">Note about convention:
All structures starting with TPM2B_ are:<a href="#appendix-A.2.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.5-3.1">
              <p id="appendix-A.2.5-3.1.1">a structure that is a sized buffer where the size of the buffer is contained in a 16-bit, unsigned value.<a href="#appendix-A.2.5-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.2.5-3.2">
              <p id="appendix-A.2.5-3.2.1">The first parameter is the size in octets of the second parameter. The second parameter may be any type.<a href="#appendix-A.2.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-A.2.5-4">A full explanation of the TPM structures is outside the scope of this document. As a
simplification references to TPM2B_ structures will simply use the enclosed
TPMT_ structure by the same name following the '_'.<a href="#appendix-A.2.5-4" class="pilcrow">¶</a></p>
<div id="tpm2-object-names">
<section id="appendix-A.2.5.1">
            <h5 id="name-tpm2-object-names">
<a href="#appendix-A.2.5.1" class="section-number selfRef">A.2.5.1. </a><a href="#name-tpm2-object-names" class="section-name selfRef">TPM2 Object Names</a>
            </h5>
<p id="appendix-A.2.5.1-1">All TPM2 Objects (e.g., keys are key objects which is the focus of this specification).
A TPM2 object name is persistent across the object's life cycle whether the TPM2
object is transient or persistent.<a href="#appendix-A.2.5.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.5.1-2">A TPM2 Object name is a concatenation of a hash algorithm identifier and a hash of
the TPM2 Object's TPMT_PUBLIC.<a href="#appendix-A.2.5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.5.1-3">
<pre>
     Name ≔ nameAlg || HnameAlg (handle→publicArea)
     nameAlg is a TCG defined 16 bit algorithm identifier
</pre><a href="#appendix-A.2.5.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.5.1-4">publicArea is the TPMT_PUBLIC structure for that TPM2 Object.<a href="#appendix-A.2.5.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2.5.1-5">The size of the Name field can be derived by examining the nameAlg value, which defines
the hashing algorithm and the resulting size.<a href="#appendix-A.2.5.1-5" class="pilcrow">¶</a></p>
<p id="appendix-A.2.5.1-6">The Name field is returned in the TPM2B_ATTEST data field.<a href="#appendix-A.2.5.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.5.1-7">
<pre>
     typedef struct {
          TPM_GENERATED magic;
          TPMI_ST_ATTEST type;
          TPM2B_NAME qualifiedSigner;
          TPM2B_DATA extraData;
          TPMS_CLOCK_INFO clockInfo;
          UINT64 firmwareVersion;
          TPMU_ATTEST attested;
     } TPMS_ATTEST;
</pre><a href="#appendix-A.2.5.1-7" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.5.1-8">where for a key object the attested field is<a href="#appendix-A.2.5.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.5.1-9">
<pre>
     typedef struct {
          TPM2B_NAME name;
          TPM2B_NAME qualifiedName;
     } TPMS_CERTIFY_INFO;
</pre><a href="#appendix-A.2.5.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="tpm2-public-structure">
<section id="appendix-A.2.5.2">
            <h5 id="name-tpm2-public-structure">
<a href="#appendix-A.2.5.2" class="section-number selfRef">A.2.5.2. </a><a href="#name-tpm2-public-structure" class="section-name selfRef">TPM2 Public Structure</a>
            </h5>
<p id="appendix-A.2.5.2-1">Any TPM2 Object has an associated TPM2 Public structure defined
as TPMT_PUBLIC. This is defined below as a 'C' structure. While there
are many types of TPM2 Objects each with its own specific TPMT_PUBLIC
structure (handled by the use of 'unions') this document will specifically
define TPMT_PUBLIC for a TPM2 key object.<a href="#appendix-A.2.5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.5.2-2">
<pre>
     typedef struct {
          TPMI_ALG_PUBLIC type;
          TPMI_ALG_HASH nameAlg;
          TPMA_OBJECT objectAttributes;
          TPM2B_DIGEST authPolicy;
          TPMU_PUBLIC_PARMS parameters;
          TPMU_PUBLIC_ID unique;
     } TPMT_PUBLIC;
</pre><a href="#appendix-A.2.5.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.5.2-3">Where:
* type and nameAlg are 16 bit TCG defined algorithms.
* objectAttributes is a 32 bit field defining properties of the object, as shown below<a href="#appendix-A.2.5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.5.2-4">
<pre>
     typedef struct TPMA_OBJECT {
          unsigned Reserved_bit_at_0 : 1;
          unsigned fixedTPM : 1;
          unsigned stClear : 1;
          unsigned Reserved_bit_at_3 : 1;
          unsigned fixedParent : 1;
          unsigned sensitiveDataOrigin : 1;
          unsigned userWithAuth : 1;
          unsigned adminWithPolicy : 1;
          unsigned Reserved_bits_at_8 : 2;
          unsigned noDA : 1;
          unsigned encryptedDuplication : 1;
          unsigned Reserved_bits_at_12 : 4;
          unsigned restricted : 1;
          unsigned decrypt : 1;
          unsigned sign : 1;
          unsigned x509sign : 1;
          unsigned Reserved_bits_at_20 : 12;
     } TPMA_OBJECT;
</pre><a href="#appendix-A.2.5.2-4" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="appendix-A.2.5.2-5.1">
                <p id="appendix-A.2.5.2-5.1.1">authPolicy is the Policy Digest needed to authorize use of the object.<a href="#appendix-A.2.5.2-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.2.5.2-5.2">
                <p id="appendix-A.2.5.2-5.2.1">Parameters are the object type specific public information about the key.<a href="#appendix-A.2.5.2-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.5.2-5.2.2.1">
                    <p id="appendix-A.2.5.2-5.2.2.1.1">For key objects, this would be the key's public parameters.<a href="#appendix-A.2.5.2-5.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="appendix-A.2.5.2-5.3">
                <p id="appendix-A.2.5.2-5.3.1">unique is the identifier for parameters<a href="#appendix-A.2.5.2-5.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="appendix-A.2.5.2-6">The size of the TPMT_PUBLIC is provided by the following structure:<a href="#appendix-A.2.5.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.5.2-7">
<pre>
     typedef struct {
          UINT16     size;
          TPMT_PUBLIC publicArea;
     } TPM2B_PUBLIC;
</pre><a href="#appendix-A.2.5.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="tpm2-signatures">
<section id="appendix-A.2.5.3">
            <h5 id="name-tpm2-signatures">
<a href="#appendix-A.2.5.3" class="section-number selfRef">A.2.5.3. </a><a href="#name-tpm2-signatures" class="section-name selfRef">TPM2 Signatures</a>
            </h5>
<p id="appendix-A.2.5.3-1">TPM2 signatures use a union where the first field (16 bits) identifies
the signature scheme. The example below shows an RSA signature where
TPMT_SIGNATURE-&gt;sigAlg will indicate to use TPMS_SIGNATURE_RSA
as the signature.<a href="#appendix-A.2.5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.5.3-2">
<pre>
     typedef struct {
          TPMI_ALG_SIG_SCHEME sigAlg;
          TPMU_SIGNATURE signature;
     } TPMT_SIGNATURE;

     typedef struct {
          TPMI_ALG_HASH hash;
          TPM2B_PUBLIC_KEY_RSA sig;
     } TPMS_SIGNATURE_RSA;
</pre><a href="#appendix-A.2.5.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="attestation-key">
<section id="appendix-A.2.5.4">
            <h5 id="name-attestation-key">
<a href="#appendix-A.2.5.4" class="section-number selfRef">A.2.5.4. </a><a href="#name-attestation-key" class="section-name selfRef">Attestation Key</a>
            </h5>
<p id="appendix-A.2.5.4-1">The uniquely identifying TPM2 key is the Endorsement Key (the EK). As this is a privacy
sensitive key, the EK is not directly used to attest to any TPM2 asset. Instead,
the EK is used by an Attestation CA to create an Attestation Key (the AK). The AK is
assumed trusted by the Verifier and is assume to be loaded in the TPM during the execution
of the process described in the subsequent sections. The description of how to create the AK is outside
the scope of this document.<a href="#appendix-A.2.5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attester-processing">
<section id="appendix-A.2.5.5">
            <h5 id="name-attester-processing">
<a href="#appendix-A.2.5.5" class="section-number selfRef">A.2.5.5. </a><a href="#name-attester-processing" class="section-name selfRef">Attester Processing</a>
            </h5>
<p id="appendix-A.2.5.5-1">The only signed component is the TPM2B_ATTEST structure, which returns
only the (key's) Name and the signature computed over the Name but no detailed information
about the key. As the Name is comprised of public information, the Name can
be calculated by the Verifier but only if the Verify knows all the public
information about the Key.<a href="#appendix-A.2.5.5-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.5.5-2">The Attester's processing steps are as follows:<a href="#appendix-A.2.5.5-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2.5.5-3">Using the TPM2 command TPM2_Certify obtain the TPM2B_ATTEST and TPMT_SIGNATURE structures
from the TPM2. The signing key for TPMT_SIGNATURE is an Attention Key (or AK), which is
assumed to be available to the TPM2 upfront. More details are provided in <a href="#attestation-key" class="auto internal xref">Appendix A.2.5.4</a><a href="#appendix-A.2.5.5-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2.5.5-4">The TPM2 command TPM2_Certify takes the following input:<a href="#appendix-A.2.5.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.5.5-5.1">
                <p id="appendix-A.2.5.5-5.1.1">TPM2 handle for Key (the key to be attested to)<a href="#appendix-A.2.5.5-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.2.5.5-5.2">
                <p id="appendix-A.2.5.5-5.2.1">TPM2 handle for the AK (see <a href="#attestation-key" class="auto internal xref">Appendix A.2.5.4</a>)<a href="#appendix-A.2.5.5-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="appendix-A.2.5.5-6">It produces the following output:<a href="#appendix-A.2.5.5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.5.5-7.1">
                <p id="appendix-A.2.5.5-7.1.1">TPM2B_ATTEST in binary format<a href="#appendix-A.2.5.5-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.2.5.5-7.2">
                <p id="appendix-A.2.5.5-7.2.1">TPMT_SIGNATURE in binary format<a href="#appendix-A.2.5.5-7.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="appendix-A.2.5.5-8">Then, using the TPM2 command TPM2_ReadPublic obtain the Keys TPM2B_PUBLIC structure.
While the Key's public information can be obtained by the Verifier in a number
ways, such as storing it from when the Key was created, this may be impractical
in many situations. As TPM2 provided a command to obtain this information, this
specification will include it in the TPM2 Attestation CSR extension.<a href="#appendix-A.2.5.5-8" class="pilcrow">¶</a></p>
<p id="appendix-A.2.5.5-9">The TPM2 command TPM2_ReadPublic takes the following input:<a href="#appendix-A.2.5.5-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.5.5-10.1">
                <p id="appendix-A.2.5.5-10.1.1">TPM2 handle for Key (the key to be attested to)<a href="#appendix-A.2.5.5-10.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="appendix-A.2.5.5-11">It produces the following output:<a href="#appendix-A.2.5.5-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.5.5-12.1">
                <p id="appendix-A.2.5.5-12.1.1">TPM2B_PUBLIC in binary format<a href="#appendix-A.2.5.5-12.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="verifier-processing">
<section id="appendix-A.2.5.6">
            <h5 id="name-verifier-processing">
<a href="#appendix-A.2.5.6" class="section-number selfRef">A.2.5.6. </a><a href="#name-verifier-processing" class="section-name selfRef">Verifier Processing</a>
            </h5>
<p id="appendix-A.2.5.6-1">The Verifier has to perform the following steps once it receives the Evidence:<a href="#appendix-A.2.5.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.5.6-2.1">
                <p id="appendix-A.2.5.6-2.1.1">Verify the TPM2B_ATTEST using the TPMT_SIGNATURE.<a href="#appendix-A.2.5.6-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.2.5.6-2.2">
                <p id="appendix-A.2.5.6-2.2.1">Use the Key's "expected" Name from the provided TPM2B_PUBLIC structure.
If Key's "expected" Name equals TPM2B_ATTEST-&gt;attestationData then returned TPM2B_PUBLIC is the verified.<a href="#appendix-A.2.5.6-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="appdx-tpm-example">
<section id="appendix-A.2.6">
          <h4 id="name-sample-csr">
<a href="#appendix-A.2.6" class="section-number selfRef">A.2.6. </a><a href="#name-sample-csr" class="section-name selfRef">Sample CSR</a>
          </h4>
<p id="appendix-A.2.6-1">This CSR demonstrates a certification request for a key stored in a TPM using the following structure:<a href="#appendix-A.2.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.6-2">
<pre>
CSR {
  attributes {
    id-aa-evidence {
      EvidenceBundle {
        Evidences {
          EvidenceStatement {
            type: tcg-attest-tpm-certify,
            stmt: &lt;TcgAttestTpmCertify_data&gt;
            hint: "tpmverifier.example.com"
          }
        },
        certs {
          akCertificate,
          caCertificate
        }
      }
    }
  }
}
</pre><a href="#appendix-A.2.6-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.6-3">Note that this example demonstrates most of the features of this specification:<a href="#appendix-A.2.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.6-4.1">
              <p id="appendix-A.2.6-4.1.1">The data type is identified by the OID id-TcgCsrCertify contained in the <code>EvidenceStatement.type</code> field.<a href="#appendix-A.2.6-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.2.6-4.2">
              <p id="appendix-A.2.6-4.2.1">The signed evidence is carried in the <code>EvidenceStatement.stmt</code> field.<a href="#appendix-A.2.6-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.2.6-4.3">
              <p id="appendix-A.2.6-4.3.1">The <code>EvidenceStatement.hint</code> provides information to the Relying Party about which Verifier (software) will be able to correctly parse this data. Note that the <code>type</code> OID indicates the format of the data, but that may itself be a wrapper format that contains further data in a proprietary format. In this example, the hint says that software from the package <code>"tpmverifier.example.com"</code> will be able to parse this data.<a href="#appendix-A.2.6-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.2.6-4.4">
              <p id="appendix-A.2.6-4.4.1">The evidence statement is accompanied by a certificate chain in the <code>EvidenceBundle.certs</code> field which can be used to verify the signature on the evidence statement. How the Verifier establishes trust in the provided certificates is outside the scope of this specification.<a href="#appendix-A.2.6-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-A.2.6-5">This example does not demonstrate an EvidenceBundle that contains multiple EvidenceStatements sharing a certificate chain.<a href="#appendix-A.2.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.6-6">
<pre>
-----BEGIN CERTIFICATE REQUEST-----
MIINmzCCDIUCAQAwdTELMAkGA1UEBhMCWloxETAPBgNVBAgMCFByb3ZpbmNlMREw
DwYDVQQHDAhMb2NhbGl0eTETMBEGA1UECgwKaWV0Zi1sYW1wczEXMBUGA1UECwwO
aWV0Zi1sYW1wcy1jc3IxEjAQBgNVBAMMCXRlc3Qta2V5MTCCASIwDQYJKoZIhvcN
AQEBBQADggEPADCCAQoCggEBAN/RvsGNf32W6tIAU4QZgFPs98rPv4ed7QnB9aK/
+x8u+1qhiTNpNC2me0FsQEDvToROGhkxtiift2RKPaVR2hyF05tthjNDnfDaMqvk
NN24rmzTuVZE3Oz86zSWE+Lk3ZfWHROVb5ZTME/VOZdYMAvwyi2fRHa/1cK9F/61
WwIpY4qMlLsabSsSmyd8RJ+/g3exfCeCYJ73Cu90F0wNtYOTxVN5o4ELvJdElT99
QaC38TFvJ+yW94wQua2/4Lt6cx0I+NVDFHLMELwFydVdZspqFdEGp4X+i59hjD4A
FDPOyJJJiF84Zo7+Qf1tIbUCbFV+Rmvob7uCiOs8O3ZEL4kCAwEAAaCCCuEwggrd
BgsqhkiG9w0BCRACOzGCCswwggrIMIIC2jCCAtYGBWeBBRQBMIICsgSBkf9UQ0eA
FwAiAAs7ZAoM+pOXvuDS3cZXWSGXpKzEfn3C/aWh2zIlNmdIvQAEAP9VqgAAAAB9
6ovmAAAANwAAAAABIBUBEwAVSCIAIgALRsPuEbWtPA+cXiHVz6zdm6DfOYX8urrR
WvLWAoEkW8MAIgALVNyWWGbUmLvXnu/dEowodTbdqKJlrhaYITil2pXo7ooEggEA
hnwVHoLE43BfVyozOqnx9VfsdS7U4ZOP4pS04vrfGCLegjXEHjxcMyU3DcJtd7sv
jw5/IxnLXLD/WXAe1H5XbOreOgYVejzMO16DPWBV2m7LOUvvwSsIRhHJaL5wUxfu
LZoWY6Up7Q+gFtDvoHfRrKsbeMRoOWwQulUok0PhZw0R4ZQyFrc4/rBr9kS9Vpmt
A+3IMuZ/qujraPqbC/zn1OE20+AtiKU6L9kJUtlejf8RchWn4ffi4ugK4u7RvMQS
/lGn+5G1IfVQY55iMKdlHa9nyzknQQBYopF2JP+sntC2Zf65IasWyE7NWOsQSbyr
6/OSLggeNf5gU8SrRfzaAgSCARYAAQALAAYAcgAAABAAEAgAAAAAAAEA39G+wY1/
fZbq0gBThBmAU+z3ys+/h53tCcH1or/7Hy77WqGJM2k0LaZ7QWxAQO9OhE4aGTG2
KJ+3ZEo9pVHaHIXTm22GM0Od8Noyq+Q03biubNO5VkTc7PzrNJYT4uTdl9YdE5Vv
llMwT9U5l1gwC/DKLZ9Edr/Vwr0X/rVbAiljioyUuxptKxKbJ3xEn7+Dd7F8J4Jg
nvcK73QXTA21g5PFU3mjgQu8l0SVP31BoLfxMW8n7Jb3jBC5rb/gu3pzHQj41UMU
cswQvAXJ1V1mymoV0Qanhf6Ln2GMPgAUM87IkkmIXzhmjv5B/W0htQJsVX5Ga+hv
u4KI6zw7dkQviQwXdHBtdmVyaWZpZXIuZXhhbXBsZS5jb20wggfmMIIEaTCCA1Gg
AwIBAgIUfX4oc7u4KUbyz61VtQN5g2A2QMQwDQYJKoZIhvcNAQELBQAwdzELMAkG
A1UEBhMCWloxETAPBgNVBAgMCFByb3ZpbmNlMREwDwYDVQQHDAhMb2NhbGl0eTET
MBEGA1UECgwKaWV0Zi1sYW1wczEXMBUGA1UECwwOaWV0Zi1sYW1wcy1jc3IxFDAS
BgNVBAMMC3Rlc3Qtcm9vdENBMB4XDTI0MTAyMTIwMTcxMloXDTI0MTEyMDIwMTcx
MlowczELMAkGA1UEBhMCWloxETAPBgNVBAgMCFByb3ZpbmNlMREwDwYDVQQHDAhM
b2NhbGl0eTETMBEGA1UECgwKaWV0Zi1sYW1wczEXMBUGA1UECwwOaWV0Zi1sYW1w
cy1jc3IxEDAOBgNVBAMMB3Rlc3QtYWswggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw
ggEKAoIBAQDXjF+XF1wsywJx5e5MT1Q1TD8deZqxkQYGZM9TpW+rvFjnRdSDP88M
iLOPYcRIJQ+efHvo81o6IL7n0U0TSmaP63gaMCkOLr2BgNpBHGkfSbN2b16usBrQ
cYQF+o9NU5Itt/s7knvlhNiObOeWRBgtNPXeikyHycYjcZgoGd/UDvPRiRJ0pSru
SBDeS1x0uoTsvep0JSRBUiKh8d7D0H3UCmZZzVPzVBS1Z/Vl3a3HOjUgoAvXIBzu
kh/5BKdQSh5hfRnXi5v6lJGroWFWvsHVF2PLoOC2oaIrLZ3UVa05K4wVT/wKbi0O
cReufE9rK6CvmHEAUXi1cs+jynZfYaFDAgMBAAGjgfAwge0wgZ4GA1UdIwSBljCB
k6F7pHkwdzELMAkGA1UEBhMCWloxETAPBgNVBAgMCFByb3ZpbmNlMREwDwYDVQQH
DAhMb2NhbGl0eTETMBEGA1UECgwKaWV0Zi1sYW1wczEXMBUGA1UECwwOaWV0Zi1s
YW1wcy1jc3IxFDASBgNVBAMMC3Rlc3Qtcm9vdENBghR5pP+xxKsc67pLOqPiIZSU
4fgpzDAMBgNVHRMBAf8EAjAAMAsGA1UdDwQEAwIHgDAQBgNVHSUECTAHBgVngQUI
AzAdBgNVHQ4EFgQUH4QfxvcmPg9x21uQW5cfGyfxbMcwDQYJKoZIhvcNAQELBQAD
ggEBAC3Zz6B+u1H+72CG0j/s6lRPX/YP/DPjh5IIt9HdOJaWc5lsbCvgHSED7N/+
voCfCRf7IU2Oh5+2q9+9N5ARinXPmrsPZNyLR8vWkb27/hl9OTi0Ly7DtJMtUJTR
zq53dZc7kdTDNYpPnbIbanSOW3lSL5E173C8wyTsp/vQKteYTfmsDKw9hXHIU2eS
eUpZmKcHShXlbDEEbTuYLJMDASKmMCmPjIgJrSX/18wEoAgo2BVjjzwfhoc2SLnQ
dikvN6oa6Ee0zYRiImXpM7cuErC88jOr0quURA1U8fsQd8hYGRUk/6oPMXzIfZKs
z/yzAUQ570+mkdd2iFVlqTCQ9eUwggN1MIICXQIUeaT/scSrHOu6Szqj4iGUlOH4
KcwwDQYJKoZIhvcNAQELBQAwdzELMAkGA1UEBhMCWloxETAPBgNVBAgMCFByb3Zp
bmNlMREwDwYDVQQHDAhMb2NhbGl0eTETMBEGA1UECgwKaWV0Zi1sYW1wczEXMBUG
A1UECwwOaWV0Zi1sYW1wcy1jc3IxFDASBgNVBAMMC3Rlc3Qtcm9vdENBMB4XDTI0
MTAyMTIwMTcwOFoXDTI0MTEyMDIwMTcwOFowdzELMAkGA1UEBhMCWloxETAPBgNV
BAgMCFByb3ZpbmNlMREwDwYDVQQHDAhMb2NhbGl0eTETMBEGA1UECgwKaWV0Zi1s
YW1wczEXMBUGA1UECwwOaWV0Zi1sYW1wcy1jc3IxFDASBgNVBAMMC3Rlc3Qtcm9v
dENBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxPODF6ujxbdDWuXn
zlqzYIO4rpQKolKfKbOFUCB6SjdA5XzArLTSYKD3ZXhqm7unFkmHC2HtqArq5jgv
cQ2fzJeNGbcuyJYSwa9WJjJ5qY6gXEY+G7sFgZ5ZeEWGQ+zjrnuJh/PtlhJ2/R7w
tdC82DAULaxnFjOS6Xm6pUB8RaZEtZ6HwfPUXYgeK9IRG2CbEs8jkoBQTrSKpdpC
0myJrrS0PoTFClDpq61je7uQgU6b9IAOfXi1oX5NdYcfqxcPch4wqbkldKsjC/i7
xMcem8hnb3WUvAmbsLP1I0Fx8nb0ug/T2ED5U9tPBXbKgeD72aU2L9GNs+ypE9Az
bTB6cwIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQBFBMAGsP1xKq4R4bzbWnQ4K2H+
rYNi8UEQzxN6BiANi9+8hbLHfx6gFZlz+QxwVyH6oQnNrsVVDVjEYH4/yvy7NdOx
VitFfqOYwyaNeK5oXx1l5otOaObtwzB7RVQNSlipzEVW4RPsJmx/8F7yNLtdgooP
U0QzUSqDcoKK36E4O3s85xfyNlEdJ2vJcJ/ZZx5QQlnhNTf5bWlr3U9x6DebeAqs
+wvvepdaNzulHBXaKIqAgSx9N+Y22vj+vw8GO4L8HndDPMhdE/Ct1h1yygm65j6h
aCmQRUTKzj49q6W4NHG7iPea+7bgMq7G4LRo9DSFEfMWOkQeVUSPPiTsaAahMAsG
CSqGSIb3DQEBCwOCAQEA1aPYnm8suCRwMTC7kOdOjvVP2+2pHxsI5vnLfffFgsaN
yoOz97t6bAmQXPQCEcjCQZqAynuJQITBbf5OowrNCOL8YRLaFu2zUS8H+XJUIU0I
YSs3H8UyfeYo5VDKJClU/OcSzGgGm6J9JDQiHUuEFrqbpE19aSztpXrEH9YYP87A
NyW9vxpLse2rpE4akcp+V+C958KJEoYQc9EfjvM3LqLmzp7pvyUalv21BbOweK8V
IYVK7djq+LCmYwJwdKrOYWmrDyH8P+me8nPtk9BdcvW+sj2qu/opZmYEL4KAqAvi
BW5TzPFUgQhmMalis/J4WY3Q0tvOMXRQQZCmO2N4Pg==
-----END CERTIFICATE REQUEST-----
</pre><a href="#appendix-A.2.6-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="psa-attestation-token-in-csr">
<section id="appendix-A.3">
        <h3 id="name-psa-attestation-token-in-cs">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-psa-attestation-token-in-cs" class="section-name selfRef">PSA Attestation Token in CSR</a>
        </h3>
<p id="appendix-A.3-1">The Platform Security Architecture (PSA) Attestation Token is
defined in <span>[<a href="#I-D.tschofenig-rats-psa-token" class="cite xref">I-D.tschofenig-rats-psa-token</a>]</span> and specifies
claims to be included in an Entity Attestation
Token (EAT). <span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span> defines key attestation
based on the EAT format. In this section the platform
attestation offered by <span>[<a href="#I-D.tschofenig-rats-psa-token" class="cite xref">I-D.tschofenig-rats-psa-token</a>]</span>
is combined with key attestation by binding the
key attestation token (KAT) to the platform attestation token (PAT)
with the help of the nonce. For details see <span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>.
The resulting KAT-PAT bundle is, according to
<span><a href="https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-05#section-5.1" class="relref">Section 5.1</a> of [<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>, combined in a CMW collection
<span>[<a href="#I-D.ietf-rats-msg-wrap" class="cite xref">I-D.ietf-rats-msg-wrap</a>]</span>.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">The encoding of this KAT-PAT bundle is shown in the example below.<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3-3">
<pre>
EvidenceBundle
   +
   |
   + Evidences
   |
   +----&gt;  EvidenceStatement
        +
        |
        +-&gt; type: OID for CMW Collection
        |         1 3 6 1 5 5 7 1 TBD
        |
        +-&gt; stmt: KAT/PAT CMW Collection
</pre><a href="#appendix-A.3-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3-4">The value in EvidenceStatement-&gt;stmt is based on the
KAT/PAT example from <span><a href="https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-05#section-6" class="relref">Section 6</a> of [<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span> and
the result of CBOR encoding the CMW collection shown below
(with line-breaks added for readability purposes):<a href="#appendix-A.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3-5">
<pre>
{
  "kat":
    h'd28443A10126A058C0A30A5820B91B03129222973C214E42BF31D68
      72A3EF2DBDDA401FBD1F725D48D6BF9C8171909C4A40102200121
      5820F0FFFA7BA35E76E44CA1F5446D327C8382A5A40E5F29745DF
      948346C7C88A5D32258207CB4C4873CBB6F097562F61D5280768C
      D2CFE35FBA97E997280DBAAAE3AF92FE08A101A40102200121582
      0D7CC072DE2205BDC1537A543D53C60A6ACB62ECCD890C7FA27C9
      E354089BBE13225820F95E1D4B851A2CC80FFF87D8E23F22AFB72
      5D535E515D020731E79A3B4E47120584056F50D131FA83979AE06
      4E76E70DC75C070B6D991AEC08ADF9F41CAB7F1B7E2C47F67DACA
      8BB49E3119B7BAE77AEC6C89162713E0CC6D0E7327831E67F3284
      1A',
  "pat":
    h'd28443A10126A05824A10A58205CA3750DAF829C30C20797EDDB794
      9B1FD028C5408F2DD8650AD732327E3FB645840F9F41CAB7F1B7E
      2C47F67DACA8BB49E3119B7BAE77AEC6C89162713E0CC6D0E7327
      831E67F32841A56F50D131FA83979AE064E76E70DC75C070B6D99
      1AEC08AD'
}
</pre><a href="#appendix-A.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="confidential-compute-architecture-cca-platform-token-in-csr">
<section id="appendix-A.4">
        <h3 id="name-confidential-compute-archit">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-confidential-compute-archit" class="section-name selfRef">Confidential Compute Architecture (CCA) Platform Token in CSR</a>
        </h3>
<p id="appendix-A.4-1">The Confidential Compute Architecture (CCA) Platform Token is described in
<span>[<a href="#I-D.ffm-rats-cca-token" class="cite xref">I-D.ffm-rats-cca-token</a>]</span> and is also based on the EAT format.  Although the
full CCA attestation is composed of Realm and Platform Evidence, for the purposes
of this example only the Platform token is provided.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4-2">
<pre>
EvidenceBundle
   +
   |
   + Evidences
   |
   +----&gt;  EvidenceStatement
        +
        |
        +-&gt; type: OID for CCA Platform Attestation Toekn
        |         1 3 6 1 5 5 7 1 TBD
        |
        +-&gt; stmt: CCA Platform Token
</pre><a href="#appendix-A.4-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4-3">Although the CCA Platform Token follows the EAT/CMW format, it is untagged.
This is because the encoding can be discerned in the CSR based on the OID alone.
The untagged token based on a sample claim set is provided below:<a href="#appendix-A.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4-4">
<pre>
(long lines wrapped for readability)

/ Sample Platform Claims Set in CDDL                          /
{
   / cca-platform-profile / 265:"tag:arm.com,2023:cca_platform#1.0.0"
   / arm-platform-challenge, SHA-256 calculation of ‘RAK’ / 10:
            h'c9cdc457ebe981d563b19b5a8e0e3cbef5b944d58e278c9c6779f
            77beb65bbd5’
   / arm-platform-lifecycle / 2395: h'3000' /secured/
   / arm-platform-sw-components / 2399: [ {1:"ROTFMC", 2:h'903a36d3a
            0a511ecac4548fee8601af54247c110ce220f680a0b274441729105’,
            5:h'd4cf61e472d18c8e926ce0d44496674792587c88706e8a123b294
            c000895d9ea’},
      {1:"ROTFW", 2:h'59d4116525e974b5b62ffd7c4ffcbaa0b98e08263403aeb
            6638797132d2af959’, 5:h'd4cf61e472d18c8e926ce0d4449667479
            2587c88706e8a123b294c000895d9ea’} ]
   /arm-platform-id/ 256: h’ 946338159d767f9f37098a00a60f133b6d57886f
            c656f5f9eed13760b4893fa1’
   /arm-platform-implementation-id/ 2396: h’0000000000000000000000000
            000000000000000000000000000000000000001’
}

/ This is a full CWT-formatted token. The payload is a sample
/ Platform Claim Set. The main structure                       /
/ visible is that of the COSE_Sign1.                          /

61( 18( [
    h'a10126',  / protected headers  /
    {}, / empty unprotected headers /
    h’a419010978237461673a61726d2e636f6d2c323032333a6363615f706c746
    66f726d23312e392e300a580020c9cdc457ebe981d563b19b5a8e0e3cbef5b9
    44d58e278c9c6779f77beb65bbd519095b42300019095f82a30166524f54464
    d4302580020903a36d3a0a511ecac4548fee8601af54247c110ce220f680a0b
    27444172910505580020d4cf61e472d18c8e926ce0d44496674792587c88706
    e8a123b294c000895d9eaae0165524f5446575800200259d4116525e974b5b6
    2ffd7c4ffcbaa0b98e08263403aeb6638797132d2af95905580020d4cf61e47
    2d18c8e926ce0d44496674792587c88706e8a123b294c000895d9ea19010078
    20946338159d767f9f37098a00a60f133b6d57886fc656f5f9eed13760b4893
    fa11a095c582000000000000000000000000000000000000000000000000000
    00000000000001' /payload/
    h'cbbfa929cb9b846cb5527d7ef9b7657256412a5f22a6e1a8d3a0c71145022
    100db4b1b97913b1cd9d6e11c1fadbc0869882ba6644b9db09d221f198e3286
    654b' /signature/
] ) )

/Untagged serialized token/
h'8443a10126a0590141a419010978237461673a61726d2e636f6d2c323032333a
6363615f706c74666f726d23312e392e300a580020c9cdc457ebe981d563b19b5a
8e0e3cbef5b944d58e278c9c6779f77beb65bbd519095b42300019095f82a30166
524f54464d4302580020903a36d3a0a511ecac4548fee8601af54247c110ce220f
680a0b27444172910505580020d4cf61e472d18c8e926ce0d44496674792587c88
706e8a123b294c000895d9eaae0165524f5446575800200259d4116525e974b5b6
2ffd7c4ffcbaa0b98e08263403aeb6638797132d2af95905580020d4cf61e472d1
8c8e926ce0d44496674792587c88706e8a123b294c000895d9ea19010078209463
38159d767f9f37098a00a60f133b6d57886fc656f5f9eed13760b4893fa11a095c
582000000000000000000000000000000000000000000000000000000000000000
015840cbbfa929cb9b846cb5527d7ef9b7657256412a5f22a6e1a8d3a0c7114502
2100db4b1b97913b1cd9d6e11c1fadbc0869882ba6644b9db09d221f198e3286654b'
</pre><a href="#appendix-A.4-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4-5">Realm evidence can be included in a CMW bundle, similar to the PSA token.
In this case, the CSR is constructed as follows:<a href="#appendix-A.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4-6">
<pre>
EvidenceBundle
   +
   |
   + Evidences
   |
   +----&gt;  EvidenceStatement
        +
        |
        +-&gt; type: OID for CMW Collection
        |         1 3 6 1 5 5 7 1 TBD
        |
        +-&gt; stmt: Realm Token/Platform Token CMW Collection or
                         Realm Claim Set/Platform Token CMW Collection
</pre><a href="#appendix-A.4-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="asn1-module">
<section id="appendix-B">
      <h2 id="name-asn1-module">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-asn1-module" class="section-name selfRef">ASN.1 Module</a>
      </h2>
<div class="alignLeft art-text artwork" id="appendix-B-1">
<pre>
CSR-ATTESTATION-2025
  { iso(1) identified-organization(3) dod(6) internet(1) security(5)
  mechanisms(5) pkix(7) id-mod(0) id-mod-pkix-attest-01(TBDMOD) }

CsrAttestation DEFINITIONS IMPLICIT TAGS ::= BEGIN

EXPORTS ALL;

IMPORTS

Certificate, id-pkix
FROM PKIX1Explicit-2009 -- from [RFC5912]
{ iso(1) identified-organization(3) dod(6) internet(1)
security(5) mechanisms(5) pkix(7) id-mod(0)
id-mod-pkix1-explicit-02(51) }

CertificateChoices
  FROM CryptographicMessageSyntax-2010
    { iso(1) member-body(2) us(840) rsadsi(113549)
    pkcs(1) pkcs-9(9) smime(16) modules(0) id-mod-cms-2009(58) }

EXTENSION, ATTRIBUTE, AttributeSet{}, SingleAttribute{}
FROM PKIX-CommonTypes-2009 -- from [RFC5912]
{ iso(1) identified-organization(3) dod(6) internet(1)
security(5) mechanisms(5) pkix(7) id-mod(0)
id-mod-pkixCommon-02(57) }

id-aa
  FROM SecureMimeMessageV3dot1
    { iso(1) member-body(2) us(840) rsadsi(113549)
    pkcs(1) pkcs-9(9) smime(16) modules(0) msg-v3dot1(21) }
  ;

-- Branch for attestation statement types
id-ata OBJECT IDENTIFIER ::= { id-aa (TBD1) }

EVIDENCE-STATEMENT ::= TYPE-IDENTIFIER

EvidenceStatementSet EVIDENCE-STATEMENT ::= {
   ... -- None defined in this document --
}

ATTESTATION-RESULT ::= TYPE-IDENTIFIER

AttestationResultSet ATTESTATION-RESULT ::= {
   ... -- None defined in this document --
}

EvidenceStatement ::= SEQUENCE {
   type   EVIDENCE-STATEMENT.&amp;id({EvidenceStatementSet}),
   stmt   EVIDENCE-STATEMENT.&amp;Type({EvidenceStatementSet}{@type}),
   hint   UTF8String OPTIONAL
}

AttestationResult ::= SEQUENCE {
   type   ATTESTATION-RESULT.&amp;id({AttestationResultSet}),
   stmt   ATTESTATION-RESULT.&amp;Type({AttestationResultSet}{@type}),
}

-- Arc for Evidence types
id-aa-evidence OBJECT IDENTIFIER ::= { id-aa 59 }

-- Arc for Attestation Result types
id-aa-ar OBJECT IDENTIFIER ::= { id-ata (TBD2) }

-- For PKCS#10 (Evidence)
attr-evidence ATTRIBUTE ::= {
  TYPE EvidenceBundle
  COUNTS MAX 1
  IDENTIFIED BY id-aa-evidence
}

-- For CRMF (Evidence)
ext-evidence EXTENSION ::= {
  SYNTAX EvidenceBundle
  IDENTIFIED BY id-aa-evidence
}

-- For PKCS#10 (Attestation Result)
attr-ar ATTRIBUTE ::= {
  TYPE AttestationResultBundle
  COUNTS MAX 1
  IDENTIFIED BY id-aa-ar
}

-- For CRMF (Attestation Result)
ext-ar EXTENSION ::= {
  SYNTAX AttestationResultBundle
  IDENTIFIED BY id-aa-ar
}

EvidenceBundle ::= SEQUENCE {
   evidences SEQUENCE SIZE (1..MAX) OF EvidenceStatement,
   certs SEQUENCE SIZE (1..MAX) OF CertificateChoices OPTIONAL
      -- CertificateChoices MUST NOT contain the depreciated
      -- certificate structures or attribute certificates,
      -- see Section 10.2.2 of [RFC5652]
}

AttestationResultBundle ::= SEQUENCE SIZE (1..MAX)
                            OF AttestationResult

END
</pre><a href="#appendix-B-1" class="pilcrow">¶</a>
</div>
<div id="tcg-dice-example-in-asn1">
<section id="appendix-B.1">
        <h3 id="name-tcg-dice-example-in-asn1">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-tcg-dice-example-in-asn1" class="section-name selfRef">TCG DICE Example in ASN.1</a>
        </h3>
<p id="appendix-B.1-1">This section gives an example of extending the ASN.1 module above to carry an existing ASN.1-based Evidence Statement.
The example used is the Trusted Computing Group DICE Attestation Conceptual Message Wrapper, as defined in <span>[<a href="#TCGDICE1.1" class="cite xref">TCGDICE1.1</a>]</span>.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-2">
<pre>
CsrAttestationDiceExample DEFINITIONS IMPLICIT TAGS ::= BEGIN

IMPORTS

tcg-dice-conceptual-message-wrapper FROM TcgDiceAttestation
DiceConceptualMessageWrapper FROM TcgDiceAttestation
tcg-dice-TcbInfo FROM TcgDiceAttestation
DiceTcbInfo FROM TcgDiceAttestation
EvidenceStatementSet FROM CsrAttestation
;

tcgDiceCmwEvidenceStatementES EVIDENCE-STATEMENT ::= {
  DiceConceptualMessageWrapper IDENTIFIED BY tcg-dice-conceptual-
                                                    message-wrapper }

tcgDiceTcbInfoEvidenceStatementES EVIDENCE-STATEMENT ::= {
  DiceTcbInfo IDENTIFIED BY tcg-dice-TcbInfo }
-- where ConceptualMessageWrapper, tcg-dice-conceptual-message-
                                                            wrapper,
-- DiceTcbInfo, and tcg-dice-TcbInfo
-- are defined in DICE-Attestation-Architecture-Version-1.1-
--                                        Revision-18_6Jan2024.pdf

EvidenceStatementSet EVIDENCE-STATEMENT ::= {
  tcgDiceEvidenceStatementES,
  tcgDiceTcbInfoEvidenceStatementES
  ...
}
END

TcgDiceAttestation DEFINITIONS AUTOMATIC TAGS ::= BEGIN

EXPORTS ALL;

tcg OBJECT IDENTIFIER ::= { 2 23 133 }
tcg-dice OBJECT IDENTIFIER ::= { tcg platformClass(5) dice(4) }
tcg-dice-TcbInfo OBJECT IDENTIFIER ::= { tcg-dice tcbinfo(1) }
tcg-dice-endorsement-manifest-uri OBJECT IDENTIFIER ::= {
                                      tcg-dice manifest-uri(3) }
tcg-dice-Ueid OBJECT IDENTIFIER ::= { tcg-dice ueid(4) }
tcg-dice-MultiTcbInfo OBJECT IDENTIFIER ::= {tcg-dice
                                                multitcbinfo(5) }
tcg-dice-UCCS-evidence OBJECT IDENTIFIER ::= {tcg-dice
                                                uccs-evidence(6) }
tcg-dice-manifest-evidence OBJECT IDENTIFIER ::= {tcg-dice
                                              manifest-evidience(7) }
tcg-dice-MultiTcbInfoComp OBJECT IDENTIFIER ::= {tcg-dice
                                                multitcbinfocomp(8) }
tcg-dice-conceptual-message-wrapper OBJECT IDENTIFIER ::= {
                                                    tcg-dice cmw(9) }
tcg-dice-TcbFreshness OBJECT IDENTIFIER ::= { tcg-dice
                                                tcb-freshness(11) }

DiceConceptualMessageWrapper ::= SEQUENCE {
  cmw OCTET STRING
}

DiceTcbInfo ::= SEQUENCE {
  vendor [0] IMPLICIT UTF8String OPTIONAL,
  model [1] IMPLICIT UTF8String OPTIONAL,
  version [2] IMPLICIT UTF8String OPTIONAL,
  svn [3] IMPLICIT INTEGER OPTIONAL,
  layer [4] IMPLICIT INTEGER OPTIONAL,
  index [5] IMPLICIT INTEGER OPTIONAL,
  fwids [6] IMPLICIT FWIDLIST OPTIONAL,
  flags [7] IMPLICIT OperationalFlags OPTIONAL,
  vendorInfo [8] IMPLICIT OCTET STRING OPTIONAL,
  type [9] IMPLICIT OCTET STRING OPTIONAL,
  flagsMask [10]IMPLICIT OperationalFlagsMask OPTIONAL,
  integrityRegisters [11] IMPLICIT IrList OPTIONAL
}

FWIDLIST ::= SEQUENCE SIZE (1..MAX) OF FWID
  FWID ::= SEQUENCE {
  hashAlg OBJECT IDENTIFIER,
  digest OCTET STRING
}

OperationalFlags ::= BIT STRING {
  notConfigured (0),
  notSecure (1),
  recovery (2),
  debug (3),
  notReplayProtected (4),
  notIntegrityProtected (5),
  notRuntimeMeasured (6),
  notImmutable (7),
  notTcb (8),
  fixedWidth (31)
}

OperationalFlagsMask ::= BIT STRING {
  notConfigured (0),
  notSecure (1),
  recovery (2),
  debug (3),
  notReplayProtected (4),
  notIntegrityProtected (5),
  notRuntimeMeasured (6),
  notImmutable (7),
  notTcb (8),
  fixedWidth (31)
}

IrList ::= SEQUENCE SIZE (1..MAX) OF IntegrityRegister

IntegrityRegister ::= SEQUENCE {
  registerName IA5String OPTIONAL,
  registerNum INTEGER OPTIONAL,
  hashAlg OBJECT IDENTIFIER,
  digest OCTET STRING
}

EndorsementManifestURI ::= SEQUENCE {
  emUri UTF8String
}

TcgUeid ::= SEQUENCE {
  ueid OCTET STRING
}

DiceTcbInfoSeq ::= SEQUENCE SIZE (1..MAX) OF DiceTcbInfo

DiceTcbInfoComp ::= SEQUENCE SIZE (1..MAX) OF TcbInfoComp

TcbInfoComp ::= SEQUENCE {
  commonFields [0] IMPLICIT DiceTcbInfo,
  evidenceValues [1] IMPLICIT DiceTcbInfoSeq
}

UccsEvidence ::= SEQUENCE {
  uccs OCTET STRING
}

Manifest ::= SEQUENCE {
  format ManifestFormat,
  manifest OCTET STRING
}

ManifestFormat ::= ENUMERATED {
  swid-xml    (0),
  coswid-cbor (1),
  coswid-json (2),
  tagged-cbor (3)
}

DiceTcbFreshness ::= SEQUENCE {
  nonce OCTET STRING
}
END
</pre><a href="#appendix-B.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="tcg-dice-tcbinfo-example-in-csr">
<section id="appendix-B.2">
        <h3 id="name-tcg-dice-tcbinfo-example-in">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-tcg-dice-tcbinfo-example-in" class="section-name selfRef">TCG DICE TcbInfo Example in CSR</a>
        </h3>
<p id="appendix-B.2-1">This section gives an example of extending the ASN.1 module above to carry an existing ASN.1-based evidence statement.
The example used is the Trusted Computing Group DiceTcbInfo, as defined in <span>[<a href="#TCGDICE1.1" class="cite xref">TCGDICE1.1</a>]</span>.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-2">
<pre>
﻿// SET of CSR Attributes
A0 82 00 8E
  // CSR attributes
  30 82 00 8A
    // OBJECT IDENTIFIER id-aa-evidence (1 2 840 113549 1 9 16 2 59)
    06 0B 2A 86 48 86 F7 0D 01 09 10 02 3B
      // SET -- This attribute
      31 79
        // EvidenceBundles ::= SEQUENCE SIZE (1..MAX) OF
                                                      EvidenceBundle
        30 77
          // EvidenceBundle ::= SEQUENCE
          30 75
            // EvidenceStatements ::= SEQUENCE SIZE (1..MAX)
                                                OF EvidenceStatement
            30 73
              // EvidenceStatement ::= SEQUENCE
              30 71
                // type: OBJECT IDENTIFIER tcg-dice-TcbInfo
                //                         (2.23.133.5.4.1)
                06 06 67 81 05 05 04 01
                // stmt: SEQUENCE
                30 4E
                  // CONTEXT_SPECIFIC | version (02)
                  // version = ABCDEF123456
                  82 0C 41 42 43 44 45 46 31 32 33 34 35 36
                  // CONTEXT_SPECIFIC | svn (03)
                  // svn = 4
                  83 01 04
                  // CONTEXT_SPECIFIC | CONSTRUCTED | fwids (06)
                  A6 2F
                  // SEQUENCE
                  30 2D
                    // OBJECT IDENTIFIER SHA256
                    06 09 60 86 48 01 65 03 04 02 01
                    // OCTET STRING
                    // fwid = 0x0000....00
                    04 20 00 00 00 00 00 00 00 00
                    00 00 00 00 00 00 00 00
                    00 00 00 00 00 00 00 00
                    00 00 00 00 00 00 00 00
                  // CONTEXT_SPECIFIC | vendorInfo (08)
                  // vendor info = 0x00000000
                  88 04 00 00 00 00
                  // CONTEXT_SPECIFIC | type (09)
                  // type = 0x00000000
                  89 04 00 00 00 00
                // hint: UTF8STRING "DiceTcbInfo.example.com"
                0C 17 44 69 63 65 54 63 62 49 6e 66 6f
                2e 65 78 61 6d 70 6c 65 2e 63 6f 6d

// BER only
A0 82 00 8E 30 82 00 8A 06 0B 2A 86 48 86 F7 0D
01 09 10 02 3B 30 7B 31 79 30 77 30 75 30 73 30
71 06 06 67 81 05 05 04 01 30 4E 82 0C 41 42 43
44 45 46 31 32 33 34 35 36 83 01 04 A6 2F 30 2D
06 09 60 86 48 01 65 03 04 02 01 04 20 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 88 04 00
00 00 00 89 04 00 00 00 00 0C 17 44 69 63 65 54
63 62 49 6e 66 6f 2e 65 78 61 6d 70 6c 65 2e 63
6f 6d
</pre><a href="#appendix-B.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">This specification is the work of a design team created by the chairs of the
LAMPS working group. The following persons, in no specific order,
contributed to the work directly, participated in design team meetings, or provided review of the document.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">Richard Kettlewell, Chris Trufan, Bruno Couillard,
Jean-Pierre Fiset, Sander Temme, Jethro Beekman, Zsolt Rózsahegyi, Ferenc
Pető, Mike Agrenius Kushner, Tomas Gustavsson, Dieter Bong, Christopher Meyer, Carl Wallace, Michael Richardson, Tomofumi Okubo, Olivier
Couillard, John Gray, Eric Amador, Darren Johnson, Herman Slatman, Tiru Reddy, James Hagborg, A.J. Stein, John Kemp, Daniel Migault and Russ Housley.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">We would like to specifically thank Mike StJohns for his work on an earlier
version of this draft.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">We would also like to specifically thank Giri Mandyam for providing the
appendix illustrating the confidential computing scenario, and to Corey
Bonnell for helping with the hackathon scripts to bundle it into a CSR.<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<p id="appendix-C-5">Finally, we would like to thank Andreas Kretschmer, Hendrik Brockhaus,
David von Oheimb, and Thomas Fossati for their feedback based on implementation
experience.<a href="#appendix-C-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Ounsworth</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div dir="auto" class="left"><span class="street-address">2500 Solandt Road – Suite 100</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K2K 3G5</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mike.ounsworth@entrust.com" class="email">mike.ounsworth@entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">Siemens</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Hannes.Tschofenig@gmx.net" class="email">Hannes.Tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@sit.fraunhofer.de" class="email">henk.birkholz@sit.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Monty Wiseman</span></div>
<div dir="auto" class="left"><span class="org">Beyond Identity</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:monty.wiseman@beyondidentity.com" class="email">monty.wiseman@beyondidentity.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ned Smith</span></div>
<div dir="auto" class="left"><span class="org">Intel Corporation</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ned.smith@intel.com" class="email">ned.smith@intel.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
